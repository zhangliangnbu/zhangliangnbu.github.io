---
title: 开发笔记-Gradle下载公司内部依赖失败问题排查
date: 2018-09-29 09:26:42
updated: 2018-10-17 14:52:48
tags:
- Android
- Gradle
- Build
- 开发笔记
categories:
- Android开发
---



# 问题描述 

最近的一个项目使用了公司自己的Maven库中的依赖，这个Maven库只能用公司内网访问。开始我设置了代理，`sync`后，有部分依赖不能下载，有时候`sync`依然会成功，但`build`一定会失败，执行`./gradlew build --stacktrack`,获得错误信息如下： 

```shell 
Could not resolve xxxxx.xxx.xxx.xxx. 
```

只是公司自己的Maven库依赖不能解析，其他三方库依赖没有报错。 



# 问题排查 

排查思路如下： 

**一，确定公司内部Maven库能够从自己的电脑上访问** 

1. 是否能够`ping`通？ 

   `$ ping xxx.xxx.xxx(公司内部Maven库服务地址) `。 

2. 能够`ping`通后，再用浏览器尝试访问公司内部Maven库，看能够找到需要的依赖。 



确定公司内部Maven库能够被访问后，再看下一步 

**二，确定自己的Gradle没有设置外部代理** 

如果设置了外部代理，则是从外部网络访问公司内部Maven，肯定是访问不了的。依次检查如下： 

1. 项目根目录下的`gradle.properties`是否设置了代理。 

2. Android Studio是否设置了代理。”Preference -> Appearence&Behavior -> System Settings -> HTTP Proxy" 

3. 用户主目录`~/.gradle/gradle.properties`中是否设置了全局代理。 

如果设置了代理，则关闭所有的代理或者设置内部Maven库地址不走代理，而其他的走代理。 



**内部Maven库地址不走代理设置** 

`gradle.properties`设置如下： 

```properties
systemProp.http.nonProxyHosts=xxxx.xxxx.xxxx 
```



Android Studio设置如下： 

在”Preference -> Appearence&Behavior -> System Settings -> HTTP Proxy"中的"No proxy for"中填入公司内部Host主机地址。 