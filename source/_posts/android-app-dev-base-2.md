---
title: Androidåº”ç”¨å¼€å‘åŸºç¡€äºŒï¼šActivity
date: 2018-08-11 15:14:22
updated: 2022-01-10 17:52:48
tags:
- android
categories:
- Androidå¼€å‘
---

# Activity ç”Ÿå‘½å‘¨æœŸ

å®Œæ•´ç”Ÿå‘½å‘¨æœŸæµç¨‹ï¼š

1. ä¸€èˆ¬çš„æµç¨‹ï¼šonCreate() â†’ onStart() â†’ onResume() â†’ onPause() â†’ onStop() â†’ onDestory()
2. éæ­£å¸¸é”€æ¯ï¼šonCreate() â†’ onStart() â†’ onResume() â†’ onPause() â†’ onCreate()
3. éæ­£å¸¸é”€æ¯ï¼šonCreate() â†’ onStart() â†’ onResume() â†’ onPause() â†’ onStop() â†’  onCreate()
4. å¯è§çš„è¿”å›ï¼šonCreate() â†’ onStart() â†’ onResume() â†’ onPause() â†’ onResume()
5. ä¸å¯è§è¿”å›ï¼šonCreate() â†’ onStart() â†’ onResume() â†’ onPause() â†’ onStop() â†’ onRestart() â†’ onStart()

<!-- more -->

![android-activity-lifecycle](/images/android-activity-lifecycle.png)

**ç”Ÿå‘½å‘¨æœŸå›è°ƒæ–¹æ³•**

- onCreate()ï¼šæ‰§è¡ŒåŸºæœ¬å¯åŠ¨é€»è¾‘ã€‚è¯¥é€»è¾‘åœ¨ Activity çš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸä¸­åªåº”å‘ç”Ÿä¸€æ¬¡ï¼Œæ¯”å¦‚ï¼šå£°æ˜ç•Œé¢ã€å®šä¹‰æˆå‘˜å˜é‡ã€é…ç½®ç•Œé¢ã€å°†æ•°æ®ç»‘å®šåˆ°åˆ—è¡¨ï¼Œå°† Activity ä¸ ViewModel ç›¸å…³è”ã€å®ä¾‹åŒ–æŸäº›ç±»ä½œç”¨åŸŸå˜é‡ç­‰ã€‚
- onStart()ï¼š1. onStart() è°ƒç”¨å Activity å¯¹ç”¨æˆ·å¯è§ã€‚2.åˆå§‹åŒ–ç»´æŠ¤ç•Œé¢çš„ä»£ç ã€‚3. å›è°ƒä¼šéå¸¸å¿«é€Ÿåœ°å®Œæˆã€‚
- onResume()ï¼šå¯è§å¹¶è·å¾—ç„¦ç‚¹ï¼›åˆå§‹åŒ–åœ¨ onPause() æœŸé—´é‡Šæ”¾çš„ç»„ä»¶ã€‚
- onPause()ï¼š1. è§¦å‘åœºæ™¯æœ‰å¸¸è§çš„å¯¼èˆªç­‰æ‰“æ–­äº‹ä»¶ã€å¤šçª—å£ã€åŠé€æ˜å¯¹è¯æ¡†ç­‰ã€‚2. é‡Šæ”¾ç•Œé¢äº¤äº’èµ„æºï¼Œå¦‚ç›¸æœºé¢„è§ˆç­‰ã€‚3. å›è°ƒä¼šéå¸¸å¿«é€Ÿåœ°å®Œæˆï¼Œä¸èƒ½æ‰§è¡Œé«˜è´Ÿè·çš„ä»»åŠ¡ã€‚
- onStop()ï¼š1. é‡Šæ”¾æˆ–è°ƒæ•´åœ¨åº”ç”¨å¯¹ç”¨æˆ·ä¸å¯è§æ—¶çš„æ— ç”¨èµ„æºï¼Œä¾‹å¦‚ï¼Œåº”ç”¨å¯ä»¥æš‚åœåŠ¨ç”»æ•ˆæœï¼Œæˆ–ä»ç²¾ç¡®ä½ç½®æ›´æ–°åˆ‡æ¢åˆ°ç²—ç•¥ä½ç½®æ›´æ–°ã€‚2. å¯ä»¥æ‰§è¡Œé«˜è´Ÿè·çš„ä»»åŠ¡ï¼Œæ¯”å¦‚æ“ä½œæ•°æ®åº“ç­‰ã€‚3. è¿›å…¥â€œå·²åœæ­¢â€çŠ¶æ€åï¼Œå¯¹è±¡å°†ç»´æŠ¤æ‰€æœ‰çŠ¶æ€å’Œæˆå‘˜ä¿¡æ¯ï¼Œå¾…æ¢å¤åï¼ŒActivity ä¼šé‡æ–°è°ƒç”¨è¿™äº›ä¿¡æ¯ã€‚æ¯”å¦‚ç”¨æˆ·åœ¨ EditText å¾®ä»¶ä¸­è¾“å…¥æ–‡æœ¬ï¼Œç³»ç»Ÿå°†ä¿ç•™æ–‡æœ¬å†…å®¹ï¼Œå› æ­¤æ‚¨æ— éœ€ä¿å­˜å’Œæ¢å¤æ–‡æœ¬ã€‚
- onDestoryï¼šé‡Šæ”¾å…ˆå‰çš„å›è°ƒï¼ˆä¾‹å¦‚ onStop()ï¼‰å°šæœªé‡Šæ”¾çš„æ‰€æœ‰èµ„æºã€‚

æ³¨æ„

- åœ¨onStart()ä¸­åˆå§‹åŒ–çš„å†…å®¹ï¼Œéœ€è¦åœ¨onStopé‡Œé‡Šæ”¾ã€‚
- åœ¨onResume()åˆå§‹åŒ–çš„å†…å®¹ï¼Œéœ€è¦åœ¨onPause()é‡Œé‡Šæ”¾ã€‚
- ç³»ç»Ÿæ°¸è¿œä¸ä¼šç›´æ¥ç»ˆæ­¢ Activity ä»¥é‡Šæ”¾å†…å­˜ï¼ˆç›´æ¥killï¼‰ï¼Œè€Œæ˜¯ä¼šç»ˆæ­¢ Activity æ‰€åœ¨çš„è¿›ç¨‹ã€‚ç³»ç»Ÿä¸ä»…ä¼šé”€æ¯ Activityï¼Œè¿˜ä¼šé”€æ¯åœ¨è¯¥è¿›ç¨‹ä¸­è¿è¡Œçš„æ‰€æœ‰å…¶ä»–å†…å®¹ã€‚

# Activity çŠ¶æ€çš„å˜æ›´

æ¶‰åŠç”¨æˆ·å’Œç³»ç»Ÿè§¦å‘çš„äº‹ä»¶å¯¼è‡´ ActivityçŠ¶æ€çš„å˜æ›´

## é…ç½®å‘ç”Ÿäº†æ›´æ”¹

- åœºæ™¯ï¼šæ¨ªç«–å±åˆ‡æ¢ã€è¯­è¨€æˆ–è¾“å…¥è®¾å¤‡çš„æ”¹å˜
- é…ç½®å‘ç”Ÿæ›´æ”¹æ—¶ï¼ŒActivity ä¼šè¢«é”€æ¯å¹¶é‡æ–°åˆ›å»ºã€‚åŸå§‹ Activity å®ä¾‹å°†è§¦å‘ onPause()ã€onStop() å’Œ onDestroy() å›è°ƒã€‚ç³»ç»Ÿå°†åˆ›å»ºæ–°çš„ Activity å®ä¾‹ï¼Œå¹¶è§¦å‘ onCreate()ã€onStart() å’Œ onResume() å›è°ƒã€‚
- å¯ä½¿ç”¨ onSaveInstanceState() æ–¹æ³•å’Œ/æˆ–æŒä¹…æ€§æœ¬åœ°å­˜å‚¨ï¼Œå¯ä½¿ Activity çš„ç•Œé¢çŠ¶æ€åœ¨é…ç½®å‘ç”Ÿæ›´æ”¹åä¿æŒä¸å˜ã€‚

## Activity æˆ–å¯¹è¯æ¡†æ˜¾ç¤ºåœ¨å‰å°

å½“ä¸€ä¸ª Activity å¯åŠ¨å¦ä¸€ä¸ª Activity æ—¶ï¼Œå®ƒä»¬éƒ½ä¼šç»å†ç”Ÿå‘½å‘¨æœŸè½¬æ¢ã€‚å…¶åŸåˆ™ä¸ºï¼šé¦–å…ˆè‡ªèº«å¤±å»ç„¦ç‚¹ï¼Œç„¶åæŠŠç›®æ ‡ Activity å°½å¿«å±•ç¤ºå‡ºæ¥ï¼Œæœ€ååœ¨åå°æ‰§è¡Œè‡ªèº«çš„ onStop()ï¼Œä»¥åŠ onDestroy()ã€‚

Activity A è¿›å…¥ B :

1. Activity A çš„ `onPause()` æ–¹æ³•æ‰§è¡Œã€‚
2. Activity B çš„ `onCreate()`ã€`onStart()`å’Œ `onResume()`æ–¹æ³•ä¾æ¬¡æ‰§è¡Œï¼ˆActivity B ç°åœ¨å…·æœ‰ç”¨æˆ·ç„¦ç‚¹ï¼‰ã€‚
3. Activity A ä¸å¯è§æ—¶ï¼Œå…¶ `onStop()`æ–¹æ³•æ‰§è¡Œã€‚

ä» Activity B è¿”å› A ï¼š

1. Activity B çš„`onPause()` æ–¹æ³•æ‰§è¡Œã€‚
2. Activity A çš„ `onRestart()`ã€`onStart() `å’Œ `onResume()`æ–¹æ³•ä¾æ¬¡æ‰§è¡Œã€‚
3. Activity B çš„ `onStop()`æ–¹æ³•æ‰§è¡Œã€‚

## ç”¨æˆ·ç‚¹æŒ‰â€œè¿”å›â€æŒ‰é’®

å¦‚æœ Activity ä½äºå‰å°ï¼Œå¹¶ä¸”ç”¨æˆ·ç‚¹æŒ‰äº†è¿”å›æŒ‰é’®ï¼ŒActivity å°†ä¾æ¬¡ç»å† onPause()ã€onStop() å’Œ onDestroy() å›è°ƒã€‚æ´»åŠ¨ä¸ä»…ä¼šè¢«é”€æ¯ï¼Œè¿˜ä¼šä»è¿”å›å †æ ˆä¸­ç§»é™¤ã€‚

éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œé»˜è®¤ä¸ä¼šè§¦å‘ onSaveInstanceState() å›è°ƒã€‚æ­¤è¡Œä¸ºåŸºäºçš„å‡è®¾æ˜¯ï¼Œç”¨æˆ·ç‚¹æŒ‰è¿”å›æŒ‰é’®æ—¶ä¸æœŸæœ›è¿”å› Activity çš„åŒä¸€å®ä¾‹ã€‚ä¸è¿‡ï¼Œæ‚¨å¯ä»¥é€šè¿‡æ›¿æ¢ onBackPressed() æ–¹æ³•å®ç°æŸç§è‡ªå®šä¹‰è¡Œä¸ºï¼Œä¾‹å¦‚â€œconfirm-quitâ€å¯¹è¯æ¡†ã€‚

## ç³»ç»Ÿç»ˆæ­¢åº”ç”¨è¿›ç¨‹

å¦‚æœæŸä¸ªåº”ç”¨å¤„äºåå°å¹¶ä¸”ç³»ç»Ÿéœ€è¦ä¸ºå‰å°åº”ç”¨é‡Šæ”¾é¢å¤–çš„å†…å­˜ï¼Œåˆ™ç³»ç»Ÿå¯èƒ½ä¼šç»ˆæ­¢åå°åº”ç”¨ä»¥é‡Šæ”¾æ›´å¤šå†…å­˜ã€‚

# çŠ¶æ€ä¿æŒå’Œæ¢å¤

ç”¨æˆ·é¢„æœŸå’Œç³»ç»Ÿè¡Œä¸ºï¼šæ ¹æ®ç”¨æˆ·æ‰§è¡Œçš„æ“ä½œï¼Œä»–ä»¬ä¼šå¸Œæœ›ç³»ç»Ÿæ¸…é™¤æˆ–ä¿ç•™ Activity çŠ¶æ€ã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨æ‰§è¡Œç”¨æˆ·é¢„æœŸçš„æ“ä½œã€‚ä½†æœ‰æ—¶ï¼Œç³»ç»Ÿä¼šæ‰§è¡Œä¸ç”¨æˆ·é¢„æœŸç›¸åçš„æ“ä½œã€‚

çŠ¶æ€ä¿å­˜ï¼šä¸€èˆ¬åœ¨onStop()ä¹‹åï¼Œä¼šè§¦å‘ onSaveInstanceState() å›è°ƒï¼Œåœ¨æ­¤æ‰§è¡Œä¿å­˜æ•°æ®çš„æ“ä½œã€‚

çŠ¶æ€æ¢å¤ï¼šåœ¨onCreate()å’ŒonRestoreInstanceState()å›è°ƒä¸­ä¼šä¼ é€’ Bundleï¼Œæ¢å¤æ•°æ®ã€‚

## ç”¨æˆ·å‘èµ·çš„æ¸…é™¤ç•Œé¢åœºæ™¯

ç”¨æˆ·å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼å®Œå…¨å…³é—­ Activityï¼š

- ä» Activity å‘ä¸Šå¯¼èˆª
- æŒ‰è¿”å›æŒ‰é’®ã€‚ä¸ä¼šè§¦å‘ onSaveInstanceState() å›è°ƒ
- å®ŒæˆæŸç§â€œå®Œæˆâ€æ“ä½œï¼ˆç”± Activity.finish() æä¾›æ”¯æŒï¼‰ã€‚ä¸ä¼šè§¦å‘ onSaveInstanceState() å›è°ƒ
- ä»â€œæ¦‚è§ˆâ€ï¼ˆâ€œæœ€è¿‘ä½¿ç”¨çš„åº”ç”¨â€ï¼‰å±å¹•ä¸­æ»‘åŠ¨å…³é—­ Activity
- ä»â€œè®¾ç½®â€ä¸­ç»ˆæ­¢åº”ç”¨

> ğŸ’¡ Android æ˜¯å¦ä¼šä¿å­˜æ•°æ®çŠ¶æ€ï¼Œä¸»è¦ä¾æ®ç”¨æˆ·çš„é¢„æœŸã€‚ä¸»åŠ¨é”€æ¯çš„ Activity ä¸€èˆ¬ä¸ä¼šä¿å­˜çŠ¶æ€ï¼Œä¹Ÿä¸ä¼šè§¦å‘ onSaveInstanceState() å›è°ƒã€‚

## ç³»ç»Ÿå‘èµ·çš„æ¸…é™¤ç•Œé¢åœºæ™¯

ç”¨æˆ·å¸Œæœ›ä¸‹æ¬¡èƒ½æ¢å¤ç•Œé¢çŠ¶æ€ï¼Œä½†ç³»ç»Ÿå¯èƒ½ä¼šæ¸…é™¤çš„åœºæ™¯

- é…ç½®æ›´æ”¹ã€‚å¦‚æ¨ªç«–å±åˆ‡æ¢ã€‚
- ç”¨æˆ·æš‚æ—¶åˆ‡æ¢åˆ°å…¶ä»–åº”ç”¨ï¼Œç¨åå†è¿”å›åˆ°å½“å‰åº”ç”¨ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ‚¨çš„åº”ç”¨ä¼šè¢«ç½®äºåå°ï¼Œç³»ç»Ÿä¼šå°½æœ€å¤§åŠªåŠ›å°†æ‚¨çš„åº”ç”¨è¿›ç¨‹ç•™åœ¨å†…å­˜ä¸­ã€‚ä½†æ˜¯ï¼Œå½“ç”¨æˆ·è½¬è€Œå»ä¸å…¶ä»–åº”ç”¨è¿›è¡Œäº’åŠ¨æ—¶ï¼Œç³»ç»Ÿå¯èƒ½ä¼šé”€æ¯è¯¥åº”ç”¨è¿›ç¨‹ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒActivity å®ä¾‹è¿åŒå…¶ä¸­å­˜å‚¨çš„ä»»ä½•çŠ¶æ€éƒ½ä¼šä¸€èµ·è¢«é”€æ¯ã€‚

è¿™ä¸¤ç§åœºæ™¯ä¸­ï¼ŒonSaveInstanceState()éƒ½ä¼šè¢«è°ƒç”¨ï¼Œä¿å­˜çš„æ•°æ®åœ¨é…ç½®æ›´æ”¹å’Œè¿›ç¨‹ç»ˆæ­¢åéƒ½ä¼šä¿ç•™ã€‚

è¿™é‡Œç‰¹åˆ«è¯´ä¸‹ é…ç½®æ›´æ”¹çš„æƒ…å†µï¼š

- åœ¨é…ç½®æ›´æ”¹æ—¶ï¼Œç³»ç»Ÿè‡ªå·±ä¼šè‡ªåŠ¨æ¢å¤ç•Œé¢æ§ä»¶çš„ä¸€äº›çŠ¶æ€æ•°æ®ï¼Œæ¯”å¦‚EditTexté‡Œçš„è¾“å…¥ï¼Œä½†ä¸ä¼šä¿å­˜TextViewç­‰è®¾ç½®çš„æ•°æ®ï¼Œä¹Ÿä¸ä¼šä¿å­˜ Activity è‡ªå®šä¹‰çš„æˆå‘˜å˜é‡çš„æ•°æ®ã€‚
- å¯åœ¨ Android.Manifest ä¸­è®¾ç½® Activity çš„å±æ€§ï¼Œå¦‚ï¼š`android:configChanges="orientation|screenSize"`ï¼Œä½¿ Activity åœ¨é…ç½®å˜åŒ–æ—¶ä¸å†é”€æ¯è€Œé‡æ–°åˆ›å»ºå®ä¾‹ï¼Œä»…ä»…è°ƒç”¨äº†`onConfigurationChanged`æ–¹æ³•ï¼Œå¯ä¿æŒæ•°æ®ä¸å˜åŒ–ã€‚ä½†å®˜æ–¹å¹¶ä¸å»ºè®®è¿™ç§è‡ªè¡Œå¤„ç†é…ç½®å˜æ›´çš„æ–¹æ³•ã€‚

> ğŸ’¡ æ³¨æ„ï¼šè‡ªè¡Œå¤„ç†é…ç½®å˜æ›´å¯èƒ½ä¼šæé«˜ä½¿ç”¨å¤‡ç”¨èµ„æºçš„éš¾åº¦ï¼Œå› ä¸ºç³»ç»Ÿä¸ä¼šä¸ºæ‚¨è‡ªåŠ¨åº”ç”¨è¿™äº›èµ„æºã€‚åªæœ‰åœ¨å¿…é¡»é¿å… Activity å› é…ç½®å˜æ›´è€Œé‡å¯çš„æ— å¥ˆæƒ…å†µä¸‹ï¼Œæ‚¨æ‰å¯è€ƒè™‘ä½¿ç”¨æ­¤æ–¹æ³•ï¼Œå¹¶ä¸”ä¸å»ºè®®å¯¹å¤§å¤šæ•°åº”ç”¨ä½¿ç”¨æ­¤æ–¹æ³•ã€‚

- è¯¦ç»†ç¤ºä¾‹è¯´æ˜ï¼šçŠ¶æ€æ”¹å˜åŠæ•°æ®ä¿å­˜

  ```kotlin
  /* 
  ç»è¿‡æ¨ªç«–å±åˆ‡æ¢åï¼Œå›è°ƒå¦‚ä¸‹
  Application.onConfigurationChanged
  Activity.onPause()
  Activity.onStop()
  Activity.onSaveInstanceState
  Activity.onDestory()
  Activity.onCrate()
  Activity.onStart()
  Activity.onRestoreInstanceState()
  Activity.onResume()
  
  EditTexté‡Œè¾“å…¥æ•°æ®ï¼Œæ¨ªç«–å±åˆ‡æ¢åä¸æ”¹å˜ï¼Œä¿å­˜äº†çŠ¶æ€
  TextView btn_showTest è¾“å…¥çš„4ï¼Œæ¨ªç«–å±åˆ‡æ¢åé‡ç½®ï¼Œæ²¡æœ‰ä¿å­˜çŠ¶æ€
  æˆå‘˜å˜é‡testIntåªèƒ½é€šè¿‡onSaveInstanceStateä¿å­˜ã€‚
  
  ------
  åœ¨AndroidManifestæ–‡ä»¶ï¼Œç»™ Activity æ·»åŠ  android:configChanges="orientation|screenSize"
  å†æ¬¡åˆ‡æ¢æ¨ªç«–å±ï¼Œå›è°ƒå¦‚ä¸‹
  Application.onConfigurationChanged
  Activity.onConfigurationChanged
  EditTextã€TextViewã€testIntçŠ¶æ€éƒ½ä¸å˜ï¼Œéƒ½å¾—åˆ°ä¿å­˜
  */
  class ActLearnActivity : AppCompatActivity() {
      companion object {
          private const val TAG = "ActLearnSample"
      }
  
      private var testInt = 0
  
      override fun onCreate(savedInstanceState: Bundle?) {
          super.onCreate(savedInstanceState)
          setContentView(R.layout.activity_act_learn)
  				// testInt = 0
          Logger.d("testInt = $testInt")
  				// åˆ‡æ¢å‰ä¸º nullï¼Œ åˆ‡æ¢åä¸º4
          Logger.d("savedInstanceState testInt = " + savedInstanceState?.get("testInt")?.toString())
  				// ç‚¹å‡»4æ¬¡ååˆ‡æ¢æ¨ªç«–å±
          btn_changeTest.setOnClickListener {
              testInt = testInt.inc()
              btn_showTest.text = testInt.toString()
          }
      }
  
      override fun onRestoreInstanceState(savedInstanceState: Bundle) {
  				super.onRestoreInstanceState(savedInstanceState)
          Logger.d("testInt = " + savedInstanceState.get("testInt")?.toString())
      }
  
      override fun onSaveInstanceState(outState: Bundle) {
          super.onSaveInstanceState(outState)
          outState.putInt("testInt", testInt)
      }
  
  		override fun onConfigurationChanged(newConfig: Configuration) {
          super.onConfigurationChanged(newConfig)
          Logger.d("orientation = ${newConfig.orientation}")
      }
  }
  ```

## ä¿å­˜å¹¶æ¢å¤æ•°æ®çš„ä¸‰ç§æ–¹æ³•

æ‚¨å¯ä»¥é€šè¿‡åœ¨å„ç§ç±»å‹çš„æŒä¹…æ€§æœºåˆ¶ä¹‹é—´åˆ’åˆ†å·¥ä½œï¼Œé«˜æ•ˆåœ°ä¿å­˜å’Œæ¢å¤ç•Œé¢çŠ¶æ€ã€‚åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œè¿™äº›æœºåˆ¶ä¸­çš„æ¯ä¸€ç§éƒ½åº”å­˜å‚¨ Activity ä¸­ä½¿ç”¨çš„ä¸åŒç±»å‹çš„æ•°æ®ï¼Œå…·ä½“å–å†³äºæ•°æ®å¤æ‚åº¦ã€è®¿é—®é€Ÿåº¦å’Œç”Ÿå‘½å‘¨æœŸçš„æƒè¡¡ï¼š

- æœ¬åœ°æŒä¹…æ€§å­˜å‚¨ï¼šå­˜å‚¨åœ¨æ‚¨æ‰“å¼€å’Œå…³é—­ Activity æ—¶ä¸å¸Œæœ›ä¸¢å¤±çš„æ‰€æœ‰æ•°æ®ã€‚ç¤ºä¾‹ï¼šæ­Œæ›²å¯¹è±¡çš„é›†åˆï¼Œå…¶ä¸­å¯èƒ½åŒ…æ‹¬éŸ³é¢‘æ–‡ä»¶å’Œå…ƒæ•°æ®ã€‚
- `ViewModel`ï¼šåœ¨å†…å­˜ä¸­å­˜å‚¨æ˜¾ç¤ºå…³è”ç•Œé¢æ§åˆ¶å™¨æ‰€éœ€çš„æ‰€æœ‰æ•°æ®ã€‚ç¤ºä¾‹ï¼šæœ€è¿‘æœç´¢çš„æ­Œæ›²å¯¹è±¡å’Œæœ€è¿‘çš„æœç´¢æŸ¥è¯¢ã€‚
- `onSaveInstanceState()]`ï¼šå­˜å‚¨å½“ç³»ç»Ÿåœæ­¢ååˆé‡æ–°åˆ›å»ºç•Œé¢æ§åˆ¶å™¨æ—¶è½»æ¾é‡æ–°åŠ è½½ Activity çŠ¶æ€æ‰€éœ€çš„å°‘é‡æ•°æ®ã€‚è¿™é‡ŒæŒ‡çš„æ˜¯å°†å¤æ‚çš„å¯¹è±¡ä¿ç•™åœ¨æœ¬åœ°å­˜å‚¨ç©ºé—´ä¸­ï¼Œå¹¶å°†è¿™äº›å¯¹è±¡çš„å”¯ä¸€ ID å­˜å‚¨åœ¨ `onSaveInstanceState()`ä¸­ï¼Œè€Œä¸æ˜¯å­˜å‚¨å¤æ‚çš„å¯¹è±¡ã€‚ç¤ºä¾‹ï¼šå­˜å‚¨æœ€è¿‘çš„æœç´¢æŸ¥è¯¢ã€‚

# ä»»åŠ¡å’Œå›é€€æ ˆ

ä»»åŠ¡ï¼ˆTaskï¼‰å’Œå›é€€æ ˆï¼ˆBack Stackï¼‰ï¼šä»»åŠ¡æ˜¯ç”¨æˆ·åœ¨æ‰§è¡ŒæŸé¡¹å·¥ä½œæ—¶ä¸ä¹‹äº’åŠ¨çš„ä¸€ç³»åˆ— Activity çš„é›†åˆã€‚è¿™äº› Activity æŒ‰ç…§æ‰“å¼€çš„é¡ºåºæ’åˆ—åœ¨ä¸€ä¸ªå›é€€æ ˆä¸­ã€‚

## ç®¡ç†ä»»åŠ¡

ä¸€èˆ¬æƒ…å†µï¼ŒActivity éµå¾ªâ€å…ˆè¿›åå‡ºâ€œçš„è¡Œä¸ºï¼Œå¯ä»¥é€šè¿‡è®¾ç½®\<activity> æ¸…å•å…ƒç´ æˆ–Intentæ”¹å˜è¿™ç§è¡Œä¸ºã€‚

> ğŸ’¡ æ³¨æ„ï¼šå¤§å¤šæ•°åº”ç”¨ä¸åº”æ‰“ç ´ Activity å’Œä»»åŠ¡çš„é»˜è®¤è¡Œä¸ºã€‚å¦‚æœæ‚¨ç¡®å®šéœ€è¦è®© Activity æ”¹å˜é»˜è®¤è¡Œä¸ºï¼Œè¯·è°¨æ…æ“ä½œï¼Œå¹¶ä¸”åŠ¡å¿…è¦æµ‹è¯•è¯¥ Activity åœ¨ä»¥ä¸‹æƒ…å†µä¸‹çš„å¯ç”¨æ€§ï¼šå¯åŠ¨æœŸé—´ä»¥åŠæ‚¨é€šè¿‡è¿”å›æŒ‰é’®ä»å…¶ä»– Activity å’Œä»»åŠ¡è¿”å›è¯¥ Activity æ—¶ã€‚åŠ¡å¿…è¦æµ‹è¯•æ˜¯å¦å­˜åœ¨å¯èƒ½ä¸ç”¨æˆ·é¢„æœŸçš„è¡Œä¸ºå†²çªçš„å¯¼èˆªè¡Œä¸ºã€‚

ç›¸å…³ `<activity>`å±æ€§åŒ…æ‹¬ï¼š

- `taskAffinity`ã€‚äº²å’Œæ€§ï¼Œè¡¨ç¤º Activity åœ¨å¯åŠ¨æ—¶å€¾å‘äºæ·»åŠ åˆ°å“ªä¸ªå›é€€æ ˆä¸­ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒåŒä¸€åº”ç”¨ä¸­çš„æ‰€æœ‰ Activity å…·æœ‰åŒä¸€äº²å’Œæ€§å€¼ã€‚ä¸¤ç§æƒ…å†µèµ·ä½œç”¨ï¼šintent åŒ…å« FLAG_ACTIVITY_NEW_TASK æ ‡è®°æ—¶ï¼Œä»¥åŠActivity çš„ allowTaskReparenting å±æ€§è®¾ä¸º "true" æ—¶ã€‚
- `launchMode`ã€‚å¯åŠ¨æ¨¡å¼ã€‚
- `allowTaskReparenting`ã€‚å…è®¸å®ä¾‹é‡æ–°åˆ†é…å›é€€æ ˆã€‚
- `clearTaskOnLaunch`ã€‚
- `alwaysRetainTaskState`ã€‚
- `finishOnTaskLaunch`ã€‚

ç›¸å…³ intent æ ‡è®°åŒ…æ‹¬ï¼š

- `FLAG_ACTIVITY_NEW_TASK`ã€‚
- `FLAG_ACTIVITY_CLEAR_TOP`ã€‚
- `FLAG_ACTIVITY_SINGLE_TOP`ã€‚

## å¯åŠ¨æ¨¡å¼åŠè®¾ç½®

è®¾ç½®å¯åŠ¨æ¨¡å¼ï¼ŒæŒ‡å®šActivityåº”è¯¥å¦‚ä½•å…³è”åˆ°ä»»åŠ¡ä¸­ã€‚å¯é€šè¿‡æ¸…å•æˆ–Intent è®¾ç½®å¯åŠ¨æ¨¡å¼ã€‚

é€šè¿‡æ¸…å•`launchMode` å±æ€§å¯è®¾ç½®å››ç§å¯åŠ¨æ¨¡å¼ï¼š

- "standard"ï¼ˆé»˜è®¤æ¨¡å¼ï¼‰ã€‚Activity å¯ä»¥å¤šæ¬¡å®ä¾‹åŒ–ï¼Œæ¯ä¸ªå®ä¾‹å¯ä»¥å±äºä¸åŒçš„ä»»åŠ¡ï¼Œä¸€ä¸ªä»»åŠ¡å¯ä»¥æ‹¥æœ‰å¤šä¸ªå®ä¾‹ã€‚
- "singleTop"ã€‚åŸºäº"standard"ï¼Œä½†å›é€€æ ˆé¡¶éƒ¨åªèƒ½æœ‰ä¸€ä¸ªå®ä¾‹ã€‚é¡¶éƒ¨æ²¡æœ‰å®ä¾‹æ—¶ä¼šåˆ›å»ºå®ä¾‹ï¼Œæœ‰å®ä¾‹æ—¶åˆ™è°ƒç”¨ onNewIntent() å¤ç”¨ã€‚
- "singleTask"ã€‚åŸºäº"singleTop"ï¼Œä½†æ•´ä¸ªç³»ç»Ÿåªæœ‰ä¸€ä¸ªå®ä¾‹ã€‚æ²¡æœ‰å®ä¾‹æ—¶ä¸€èˆ¬ä¼šåˆ›å»ºæ–°å›é€€æ ˆå’Œå®ä¾‹ï¼Œæœ‰å®ä¾‹æ—¶åˆ™è°ƒç”¨ onNewIntent() å¤ç”¨ã€‚
- "singleInstance"ã€‚åŸºäº"singleTask"ï¼Œä½†å®ä¾‹æ‰€åœ¨çš„å›é€€æ ˆåªæœ‰å…¶ä¸€ä¸ª Activityå®ä¾‹è€Œæ²¡æœ‰å…¶ä»–ã€‚æ²¡æœ‰å®ä¾‹æ—¶ä¸€èˆ¬ä¼šåˆ›å»ºæ–°å›é€€æ ˆå’Œå®ä¾‹ï¼Œæœ‰å®ä¾‹æ—¶åˆ™è°ƒç”¨ onNewIntent() å¤ç”¨ã€‚

> ğŸ’¡ ä»ä¸€ä¸ªå›é€€æ ˆ A å¯åŠ¨åœ¨å¦ä¸€ä¸ªå›é€€æ ˆ B é‡Œçš„Activityå®ä¾‹åï¼Œè¿ç»­è¿”å›åˆ™å…ˆæŠŠ B é‡Œçš„Activityæ¸…é™¤å®Œååœ¨æ¸…é™¤Aé‡Œçš„ã€‚

> ğŸ’¡ onNewIntent()ï¼šå½“å¯åŠ¨ä¸€ä¸ªActivityï¼Œä¸æ˜¯æ–°å»ºå®ä¾‹è€Œæ˜¯å¤ç”¨å·²æœ‰çš„å®ä¾‹æ—¶ï¼Œå·²æœ‰å®ä¾‹ä¼šå›è°ƒæ­¤æ–¹æ³•ã€‚onNewIntent() åœ¨ onStart() åã€onResume()å‰è°ƒç”¨ã€‚

ä½¿ç”¨ Intent æ ‡è®°ï¼ŒæŒ‡å®šå¾…å¯åŠ¨ Activity çš„æ¨¡å¼ï¼š

- FLAG_ACTIVITY_NEW_TASKã€‚ä¸ "singleTask" launchMode ç›¸åŒã€‚
- FLAG_ACTIVITY_SINGLE_TOPã€‚ä¸ "singleTop" launchMode ç›¸åŒã€‚
- FLAG_ACTIVITY_CLEAR_TOPã€‚å¦‚æœè¦å¯åŠ¨çš„ Activity å·²ç»åœ¨å½“å‰ä»»åŠ¡ä¸­è¿è¡Œï¼Œåˆ™ä¸ä¼šå¯åŠ¨è¯¥ Activity çš„æ–°å®ä¾‹ï¼Œè€Œæ˜¯ä¼šé”€æ¯ä½äºå®ƒä¹‹ä¸Šçš„æ‰€æœ‰å…¶ä»– Activityï¼Œå¹¶é€šè¿‡ onNewIntent() å°†æ­¤ intent ä¼ é€ç»™å®ƒçš„å·²æ¢å¤å®ä¾‹ï¼ˆç°åœ¨ä½äºå †æ ˆé¡¶éƒ¨ï¼‰ã€‚FLAG_ACTIVITY_CLEAR_TOP æœ€å¸¸ä¸ FLAG_ACTIVITY_NEW_TASK ç»“åˆä½¿ç”¨ã€‚

**æ³¨æ„ï¼šæ¸…å•å’Œä»£ç å†²çªæ—¶ï¼Œä»¥ Intent æ ‡è®°ä¸ºå‡†**ã€‚

# å‚è€ƒ

- å®˜ç½‘-[äº†è§£ Activity ç”Ÿå‘½å‘¨æœŸ](https://developer.android.google.cn/guide/components/activities/activity-lifecycle?hl=zh-cn#java)
- [å®˜ç½‘-äº†è§£ä»»åŠ¡å’Œè¿”å›å †æ ˆ](https://developer.android.google.cn/guide/components/activities/tasks-and-back-stack?hl=zh-cn)
- [ä¿å­˜ç•Œé¢çŠ¶æ€](https://developer.android.google.cn/topic/libraries/architecture/saving-states#ui-dismissal-system)
- [å¤„ç†é…ç½®å˜æ›´](https://developer.android.google.cn/guide/topics/resources/runtime-changes#HandlingTheChange)
