<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"zhangliangnbu.github.io","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="Developer For Android">
<meta property="og:type" content="website">
<meta property="og:title" content="永恒的码流">
<meta property="og:url" content="https://zhangliangnbu.github.io/page/3/index.html">
<meta property="og:site_name" content="永恒的码流">
<meta property="og:description" content="Developer For Android">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="章亮">
<meta property="article:tag" content="Andriod">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://zhangliangnbu.github.io/page/3/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>永恒的码流</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">永恒的码流</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">万物皆流，无物常驻</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://zhangliangnbu.github.io/2019/01/14/2019-01-14-android-mipmap-drawable-difference/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="章亮">
      <meta itemprop="description" content="Developer For Android">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="永恒的码流">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/01/14/2019-01-14-android-mipmap-drawable-difference/" class="post-title-link" itemprop="url">Drawable和Mipmap资源的区别</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-01-14 11:25:12" itemprop="dateCreated datePublished" datetime="2019-01-14T11:25:12+08:00">2019-01-14</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-06-29 14:22:39" itemprop="dateModified" datetime="2021-06-29T14:22:39+08:00">2021-06-29</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Android%E5%BC%80%E5%8F%91/" itemprop="url" rel="index"><span itemprop="name">Android开发</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="区别"><a href="#区别" class="headerlink" title="区别"></a>区别</h1><p>在apk安装的时候，<code>mipmap-xxx/</code>下的所有分辨率的图片都会保留，而<code>drawablexxx/</code>下的图片只有保留适配设备分辨率的图片，其余图片会丢弃掉，减少了APP安装大小。</p>
<blockquote>
<p>It’s best practice to place your app icons in <code>mipmap-</code> folders (not the <code>drawable-</code>folders) because they are used at resolutions different from the device’s current density。——from <a target="_blank" rel="noopener" href="https://android-developers.googleblog.com/2014/10/getting-your-apps-ready-for-nexus-6-and.html">Android Developers Blog</a></p>
<p>Using a mipmap as the source for your bitmap or drawable is a simple way to provide a quality image and various image scales, which can be particularly useful if you expect your image to be scaled during an animation. ——from <a target="_blank" rel="noopener" href="https://developer.android.com/about/versions/android-4.3">android-4.3</a></p>
<p> if you are building different versions of your app for different densities, you should know about the “mipmap” resource directory.  This is exactly like “drawable” resources, except it does not participate in density stripping when creating the different apk targets. ——from <a target="_blank" rel="noopener" href="https://plus.google.com/+DianneHackborn/posts/QTA9McYan1L">Google+ Message</a></p>
</blockquote>
<h1 id="用法"><a href="#用法" class="headerlink" title="用法"></a>用法</h1><ul>
<li><code>mipmapxxx/</code>下放置APP启动图标，以及需要高质量缩放动画的图片。</li>
<li>其他图片资源放在<code>drawablexxx/</code>下。</li>
</ul>
<hr>
<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><ul>
<li><a target="_blank" rel="noopener" href="https://android-developers.googleblog.com/2014/10/getting-your-apps-ready-for-nexus-6-and.html">Android Developers Blog</a></li>
<li><a target="_blank" rel="noopener" href="https://developer.android.com/about/versions/android-4.3">android-4.3</a></li>
<li><a target="_blank" rel="noopener" href="https://plus.google.com/+DianneHackborn/posts/QTA9McYan1L">Google+ Message</a></li>
</ul>
<hr>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://zhangliangnbu.github.io/2019/01/07/tools-mac/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="章亮">
      <meta itemprop="description" content="Developer For Android">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="永恒的码流">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/01/07/tools-mac/" class="post-title-link" itemprop="url">效率-Mac技巧</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-01-07 10:17:08" itemprop="dateCreated datePublished" datetime="2019-01-07T10:17:08+08:00">2019-01-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-06-29 14:29:37" itemprop="dateModified" datetime="2021-06-29T14:29:37+08:00">2021-06-29</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%85%B6%E4%BB%96/" itemprop="url" rel="index"><span itemprop="name">其他</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="命令行方式打开文件"><a href="#命令行方式打开文件" class="headerlink" title="命令行方式打开文件"></a>命令行方式打开文件</h1><p>执行两条命令即可，以“Sublime Text” APP为例： </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 设置命令 sublime</span></span><br><span class="line">$ <span class="built_in">echo</span> <span class="string">&quot;open -a &#x27;Sublime Text&#x27; \$*&quot;</span> &gt; /usr/<span class="built_in">local</span>/bin/sublime</span><br><span class="line">$ chmod +x /usr/<span class="built_in">local</span>/bin/sublime</span><br><span class="line"><span class="comment"># 用 sublime 打开文件</span></span><br><span class="line">$ sublime readme</span><br></pre></td></tr></table></figure>

<p>其实质是使用<code>open</code>命令以某个APP打开文件。 </p>
<blockquote>
<p>注意：应用名称”Sublime Text”取自”Applications/“文件夹下的对应的应用名称，无后缀名。</p>
</blockquote>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://zhangliangnbu.github.io/2018/12/21/2018-12-21-KotlinForAndroidDevelopersBook/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="章亮">
      <meta itemprop="description" content="Developer For Android">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="永恒的码流">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/12/21/2018-12-21-KotlinForAndroidDevelopersBook/" class="post-title-link" itemprop="url">Android开发者的Kotlin入门指南</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2018-12-21 08:43:10" itemprop="dateCreated datePublished" datetime="2018-12-21T08:43:10+08:00">2018-12-21</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-06-29 14:22:31" itemprop="dateModified" datetime="2021-06-29T14:22:31+08:00">2021-06-29</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Android%E5%BC%80%E5%8F%91/" itemprop="url" rel="index"><span itemprop="name">Android开发</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>这是一个本为Android开发者写的Kotlin入门书籍，适合想入门kotlin或使用还不够熟练的Android开发者们，可以让他们少走很多弯路。我已经使用Kotlin开发Android已有一年多了，快读读完后依旧有所收获。</p>
<ul>
<li>英文原版：<a target="_blank" rel="noopener" href="https://leanpub.com/kotlin-for-android-developers">官网书籍地址</a>、<a target="_blank" rel="noopener" href="https://book.douban.com/subject/26916501/">豆瓣地址</a></li>
<li>中文版：貌似还没有正式出版的中文版，只找到<a target="_blank" rel="noopener" href="https://wangjiegulu.gitbooks.io/kotlin-for-android-developers-zh/content/">Gitbook版本-《Kotlin for android developers》中文版翻译</a></li>
</ul>
<hr>
<h1 id="val-vs-var"><a href="#val-vs-var" class="headerlink" title="val vs var"></a>val vs var</h1><p>一般开发者当然知道不可变对象使用<code>val</code>，可变对象使用<code>var</code>。对二者的解释，书中有段话说得很好：</p>
<blockquote>
<p>一个不可变对象意味着它在实例化之后就不能再去改变它的状态了。如果你需要一 个这个对象修改之后的版本，那就会再创建一个新的对象。这个让编程更加具有健壮性和预估性。在Java中，大部分的对象是可变的，那就意味着任何可以访问它这个对象的代码都可以去修改它，从而影响整个程序的其它地方。 </p>
<p>不可变对象也可以说是线程安全的，因为它们无法去改变，也不需要去定义访问控制，因为所有线程访问到的对象都是同一个。 </p>
<p>所以在Kotlin中，如果我们想使用不可变性，我们编码时思考的方式需要有一些改变。一个重要的概念是：尽可能地使用 val 。除了个别情况（ 特别是在Android中，有很多类我们是不会去直接调用构造函数的） ，大多数时候是可以的。 </p>
</blockquote>
<hr>
<h1 id="网络请求"><a href="#网络请求" class="headerlink" title="网络请求"></a>网络请求</h1><p>简单的网络请求：<code>val data = URL(url).readText()</code>。使用了Kotlin扩展函数，之前都没有使用过，汗。</p>
<hr>
<h1 id="Anko库"><a href="#Anko库" class="headerlink" title="Anko库"></a>Anko库</h1><p>简洁的线程切换。还是要早点使用Anko库啊，汗。</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">async() &#123;</span><br><span class="line">	Request(url).run()</span><br><span class="line">	uiThread &#123; longToast(<span class="string">&quot;Request performed&quot;</span>) &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<hr>
<h1 id="委托和泛型"><a href="#委托和泛型" class="headerlink" title="委托和泛型"></a>委托和泛型</h1><p>委托和泛型估计是全书的难点和重点了。书中有个简单的例子，使用属性委托来封装SharePreference数据的获取与设置，很精彩！</p>
<p>属性委托的实现</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Preference</span>&lt;<span class="type">T</span>&gt;</span>(<span class="keyword">val</span> context: Context, <span class="keyword">val</span> name:String, <span class="keyword">private</span> <span class="keyword">val</span> default: T)</span><br><span class="line">    :ReadWriteProperty&lt;Any?, T&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">val</span> prefs <span class="keyword">by</span> lazy &#123;</span><br><span class="line">        context.getSharedPreferences(<span class="string">&quot;default&quot;</span>, Context.MODE_PRIVATE)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">getValue</span><span class="params">(thisRef: <span class="type">Any</span>?, property: <span class="type">KProperty</span>&lt;*&gt;)</span></span>: T &#123;</span><br><span class="line">        <span class="keyword">return</span> findPreference(name, default)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">setValue</span><span class="params">(thisRef: <span class="type">Any</span>?, property: <span class="type">KProperty</span>&lt;*&gt;, value: <span class="type">T</span>)</span></span> &#123;</span><br><span class="line">        putPreference(name, value)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">fun</span><span class="type">&lt;T&gt;</span> <span class="title">findPreference</span><span class="params">(name: <span class="type">String</span>, default: <span class="type">T</span>)</span></span>:T = with(prefs) &#123;</span><br><span class="line">        <span class="keyword">val</span> res: Any = <span class="keyword">when</span>(default) &#123;</span><br><span class="line">            <span class="keyword">is</span> <span class="built_in">Int</span> -&gt; getInt(name, default)</span><br><span class="line">            <span class="keyword">is</span> <span class="built_in">Long</span> -&gt; getLong(name, default)</span><br><span class="line">            <span class="keyword">is</span> <span class="built_in">Float</span> -&gt; getFloat(name, default)</span><br><span class="line">            <span class="keyword">is</span> String -&gt; getString(name, default)</span><br><span class="line">            <span class="keyword">is</span> <span class="built_in">Boolean</span> -&gt; getBoolean(name, default)</span><br><span class="line">            <span class="keyword">else</span> -&gt; <span class="keyword">throw</span> IllegalAccessException(<span class="string">&quot;this type can not be gotten from preference&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span><span class="symbol">@with</span> res <span class="keyword">as</span> T</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">fun</span><span class="type">&lt;U&gt;</span> <span class="title">putPreference</span><span class="params">(name: <span class="type">String</span>, value: <span class="type">U</span>)</span></span> = with(prefs.edit()) &#123;</span><br><span class="line">        <span class="keyword">when</span>(value) &#123;</span><br><span class="line">            <span class="keyword">is</span> <span class="built_in">Int</span> -&gt; putInt(name, value)</span><br><span class="line">            <span class="keyword">is</span> <span class="built_in">Long</span> -&gt; putLong(name, value)</span><br><span class="line">            <span class="keyword">is</span> <span class="built_in">Float</span> -&gt; putFloat(name, value)</span><br><span class="line">            <span class="keyword">is</span> String -&gt; putString(name, value)</span><br><span class="line">            <span class="keyword">is</span> <span class="built_in">Boolean</span> -&gt; putBoolean(name, value)</span><br><span class="line">            <span class="keyword">else</span> -&gt; <span class="keyword">throw</span> IllegalAccessException(<span class="string">&quot;this type can not be saved into preference&quot;</span>)</span><br><span class="line">        &#125;.apply()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>封装为方法</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">object</span> DelegateExt &#123;</span><br><span class="line">    <span class="function"><span class="keyword">fun</span><span class="type">&lt;T : Any&gt;</span> <span class="title">preference</span><span class="params">(context: <span class="type">Context</span>, name: <span class="type">String</span>, default: <span class="type">T</span>)</span></span> =</span><br><span class="line">        Preference(context, name, default)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>使用</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">KotlinForAndroidBookActivity</span> : <span class="type">AppCompatActivity</span></span>() &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">var</span> pName:String <span class="keyword">by</span> DelegateExt.preference(<span class="keyword">this</span>, <span class="string">&quot;person_name&quot;</span>, <span class="string">&quot;default&quot;</span>)</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">(savedInstanceState: <span class="type">Bundle</span>?)</span></span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState)</span><br><span class="line">        setContentView(R.layout.activity_kotlin_for_android_book)</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 设置</span></span><br><span class="line">        pName = <span class="string">&quot;liang&quot;</span></span><br><span class="line">        <span class="comment">// 获取</span></span><br><span class="line">        println(pName)</span><br><span class="line">        <span class="comment">// 抓取本地文件shared_prefs文件可以得到</span></span><br><span class="line">        <span class="comment">// &lt;?xml version=&#x27;1.0&#x27; encoding=&#x27;utf-8&#x27; standalone=&#x27;yes&#x27; ?&gt;</span></span><br><span class="line">        <span class="comment">//&lt;map&gt;</span></span><br><span class="line">        <span class="comment">//    &lt;string name=&quot;person_name&quot;&gt;liang&lt;/string&gt;</span></span><br><span class="line">        <span class="comment">//&lt;/map&gt;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>相关源码请见我的GitHub项目<a target="_blank" rel="noopener" href="https://github.com/zhangliangnbu/android-practice-demo">Android实践示例</a></p>
<hr>
<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><ol>
<li><a target="_blank" rel="noopener" href="https://github.com/Kotlin/anko">Anko</a></li>
</ol>
<hr>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://zhangliangnbu.github.io/2018/12/20/android-programming-the-big-nerd-ranch-guide-2rd-edition/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="章亮">
      <meta itemprop="description" content="Developer For Android">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="永恒的码流">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/12/20/android-programming-the-big-nerd-ranch-guide-2rd-edition/" class="post-title-link" itemprop="url">Android编程权威指南第2版</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2018-12-20 06:57:46" itemprop="dateCreated datePublished" datetime="2018-12-20T06:57:46+08:00">2018-12-20</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-06-29 14:26:30" itemprop="dateModified" datetime="2021-06-29T14:26:30+08:00">2021-06-29</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Android%E5%BC%80%E5%8F%91/" itemprop="url" rel="index"><span itemprop="name">Android开发</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>优秀的Android开发入门书籍，对于有几年开发经验的开发人员来说，也值得一读。</p>
<p>比较基础，读得很快，说一下日常开发容易忽视的地方。</p>
<hr>
<h1 id="Activity回退栈"><a href="#Activity回退栈" class="headerlink" title="Activity回退栈"></a>Activity回退栈</h1><p>获取应用任务栈（或回退栈）信息：</p>
<blockquote>
<p>不局限于单个应用，回退栈（Back Stack）作为一个整体共享给操作系统及设备使用。</p>
</blockquote>
<p>我们不仅可以获取自己APP的任务栈信息，也可以通过获取系统服务如<code>ACTIVITY_SERVICE</code>等得到其他APP任务栈信息。</p>
<p>的确可以获取自己以及其他APP任务栈信息，但不同API等级的SDK获取的方式不一样，且获取其他APP任务栈信息越来越严格。</p>
<p><strong>API 20及以下</strong></p>
<ul>
<li>通过<code>ActivityManager.getRunningTasks()</code>可以获取自己和其他APP的任务栈信息，包括栈基和栈顶Activity。</li>
</ul>
<p><strong>API 21及以上</strong></p>
<ul>
<li>通过<code>ActivityManager.getAppTasks()</code>可以获取自己APP的任务栈信息，包括栈基和栈顶Activity。</li>
<li><code>API = 21</code>时，通过<code>ActivityManager.getRunningAppProcesses()</code>可以获取相关信息。</li>
<li><code>API = 22</code>及以上时，通过<code>UsageStatsManager.queryEvents()</code>获取相关信息，但似乎还是只能获取自己APP信息，其他的获取不了。</li>
</ul>
<hr>
<h1 id="Fragment"><a href="#Fragment" class="headerlink" title="Fragment"></a>Fragment</h1><p>尽可能在Fragment里实现UI用户界面，便于复用和扩展。</p>
<blockquote>
<p>对于fragment，我们坚持AUF（AlwaysUseFragments）原则，即“总是使用fragment”。不值得为使用fragment还是activity而伤脑筋，相信我们，总是使用fragment！</p>
</blockquote>
<p>Activity的Extra和Fragment的Argument Bundle参数的Key值，应该存在使用或消耗这些值的地方。而不应该是其他仅仅传参的地方。</p>
<blockquote>
<p>一个比较好的做法是，将crimeID存储在属于CrimeFragment的某个地方，而不是保存在CrimeActivity的私有空间里。这样，无需依赖于CrimeActivity的intent内指定extra的存在，CrimeFragment就能获取自己所需的extra数据。属于fragment的“某个地方”实际就是它的argument bundle。</p>
</blockquote>
<p>一般不要在Fragment里直接定义实例变量，需要的话则记得在<code>onSaveInstanceState(Bundle)</code>里保存。</p>
<blockquote>
<p>创建实例变量的方式并不可靠。因为，在操作系统重建fragment时，设备配置发生改变时，用户暂时离开当前应用时，甚至操作系统按需回收内存时，任何实例变量都不复存在了。</p>
</blockquote>
<hr>
<h1 id="样式和主题"><a href="#样式和主题" class="headerlink" title="样式和主题"></a>样式和主题</h1><p>覆盖主题属性，便于统一管理。要找到需要覆盖的属性，一层层从下往上定位、查询即可。</p>
<p>主题和样式应该在开发初期设置，避免后期改动太多。</p>
<p>覆盖页面背景和按钮样式示例如下：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Base application theme. --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">name</span>=<span class="string">&quot;AppTheme&quot;</span> <span class="attr">parent</span>=<span class="string">&quot;Theme.AppCompat.Light.DarkActionBar&quot;</span>&gt;</span><span class="xml"></span></span><br><span class="line"><span class="xml">    <span class="comment">&lt;!-- Customize your theme here. --&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">&quot;colorPrimary&quot;</span>&gt;</span>@color/colorPrimary<span class="tag">&lt;/<span class="name">item</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">&quot;colorPrimaryDark&quot;</span>&gt;</span>@color/colorPrimaryDark<span class="tag">&lt;/<span class="name">item</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">&quot;colorAccent&quot;</span>&gt;</span>@color/colorAccent<span class="tag">&lt;/<span class="name">item</span>&gt;</span></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml">    <span class="comment">&lt;!--页面和对话框背景颜色--&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">&quot;android:colorBackground&quot;</span>&gt;</span>@color/white_light<span class="tag">&lt;/<span class="name">item</span>&gt;</span></span></span><br><span class="line"><span class="xml"> </span></span><br><span class="line"><span class="xml">  	<span class="comment">&lt;!--页面和背景颜色--&gt;</span></span></span><br><span class="line"><span class="xml">  	<span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">&quot;android:colorBackground&quot;</span>&gt;</span>@color/white_light<span class="tag">&lt;/<span class="name">item</span>&gt;</span></span></span><br><span class="line"><span class="xml">  </span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">&quot;buttonStyle&quot;</span>&gt;</span>@style/NormalButton<span class="tag">&lt;/<span class="name">item</span>&gt;</span></span></span><br><span class="line"><span class="xml"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>You can also define:</p>
<ul>
<li>textColor - The default text color of any given view</li>
<li>textColorPrimary - The default text color for enabled buttons and Large Textviews</li>
<li>textColorSecondary - The default text color for Medium and Small Textviews</li>
<li>textColorTertiary - ?</li>
</ul>
<p>(Source <a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/39070040/textcolor-vs-textcolorprimary-vs-textcolorsecondary">TextColor vs TextColorPrimary vs TextColorSecondary</a>)</p>
<hr>
<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><ol>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/AdobeSolo/article/details/77375714">Android 获取前台应用的方法总结</a></li>
<li><a target="_blank" rel="noopener" href="https://www.zhihu.com/question/39662488">关于 Android，用多个 activity，还是单 activity 配合 fragment？</a></li>
<li><a target="_blank" rel="noopener" href="https://inthecheesefactory.com/blog/fragment-state-saving-best-practices/en">The Real Best Practices to Save/Restore Activity’s and Fragment’s state</a></li>
<li><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/22141193">保存/恢复Activity和Fragment状态的最佳实践(译)</a></li>
</ol>
<hr>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://zhangliangnbu.github.io/2018/12/19/android-develop-advance/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="章亮">
      <meta itemprop="description" content="Developer For Android">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="永恒的码流">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/12/19/android-develop-advance/" class="post-title-link" itemprop="url">Android开发进阶</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2018-12-19 09:02:39" itemprop="dateCreated datePublished" datetime="2018-12-19T09:02:39+08:00">2018-12-19</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-06-29 14:24:40" itemprop="dateModified" datetime="2021-06-29T14:24:40+08:00">2021-06-29</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Android%E5%BC%80%E5%8F%91/" itemprop="url" rel="index"><span itemprop="name">Android开发</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>Android开发工程师进阶学习路线图 。</p>
<p><em>持续更新中</em></p>
<hr>
<h1 id="Android"><a href="#Android" class="headerlink" title="Android"></a>Android</h1><h2 id="基础"><a href="#基础" class="headerlink" title="基础"></a>基础</h2><ul>
<li><a target="_blank" rel="noopener" href="https://developer.android.com/guide/">Android Developer Guides</a>。官方用户指南是一切入门书籍和文档的基础；会持续更新，每年通读一遍。</li>
<li><a target="_blank" rel="noopener" href="https://developer.android.com/">Android Developer官网</a>。官方其他资料，如API、支持库、SDK新特性、Android Studio文档等。</li>
<li><a target="_blank" rel="noopener" href="https://book.douban.com/subject/26789110/">《Android权威编程指南》</a>。涵盖面全面，用实例引导开发，非常值得一读。</li>
<li><a target="_blank" rel="noopener" href="https://book.douban.com/subject/26340518/">《Android应用程序开发权威指南（第四版）》</a>。</li>
<li><a target="_blank" rel="noopener" href="https://book.douban.com/subject/11501595/">《Learning Android（中文版）》</a></li>
</ul>
<h2 id="进阶"><a href="#进阶" class="headerlink" title="进阶"></a>进阶</h2><p>应用层和框架层深化学习</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://book.douban.com/subject/26599538/">《Android开发艺术探索》</a>。</li>
<li><a target="_blank" rel="noopener" href="https://book.douban.com/subject/11530748/">《Android开发精要》</a></li>
</ul>
<p>高质量APP开发</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://book.douban.com/subject/25911738/">《Android编程实战》</a>。</li>
<li><a target="_blank" rel="noopener" href="https://book.douban.com/subject/26649050/">《App研发录》</a>。简单的架构和Crash分析。</li>
<li><a target="_blank" rel="noopener" href="https://book.douban.com/subject/25866305/">《打造高质量Android应用》</a>。各种实用技巧。</li>
<li><a target="_blank" rel="noopener" href="http://www.ituring.com.cn/book/1705">《码农19期-Android好手》</a>。</li>
</ul>
<p>性能优化</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://book.douban.com/subject/26891270/">《高性能Android应用开发》</a>。(主)</li>
<li><a target="_blank" rel="noopener" href="https://book.douban.com/subject/27036747/">《Android应用性能优化最佳实践》</a>。</li>
<li><a target="_blank" rel="noopener" href="https://book.douban.com/subject/27021800/">《Android移动性能实战》</a>。</li>
<li><a target="_blank" rel="noopener" href="https://book.douban.com/subject/26891415/">《移动App性能评测与优化》</a>。</li>
</ul>
<p>其他</p>
<ul>
<li>测试。</li>
<li>UI设计。<a target="_blank" rel="noopener" href="https://book.douban.com/subject/25769136/">《精彩绝伦的Android UI设计》</a>、<a href="%5Bhttps://book.douban.com/subject/26296679/">《移动应用UI设计模式（第2版）》</a>。</li>
<li>安全。<a target="_blank" rel="noopener" href="https://book.douban.com/subject/20556210/">《Android软件安全与逆向分析》</a>、<a target="_blank" rel="noopener" href="https://book.douban.com/subject/26348151/">《Android安全攻防权威指南》</a>。</li>
<li>其他。<a target="_blank" rel="noopener" href="https://book.douban.com/subject/25900200/">《Efficient Android Threading》</a>。</li>
</ul>
<h2 id="底层"><a href="#底层" class="headerlink" title="底层"></a>底层</h2><ul>
<li><a target="_blank" rel="noopener" href="https://book.douban.com/subject/10570841/">《Android框架揭秘》</a></li>
<li>《Android系统源代码情景分析》</li>
<li>《深入理解Android ***》系列书籍</li>
<li>《Android源码设计模式》 </li>
</ul>
<hr>
<h1 id="程序设计"><a href="#程序设计" class="headerlink" title="程序设计"></a>程序设计</h1><h2 id="Java语言"><a href="#Java语言" class="headerlink" title="Java语言"></a>Java语言</h2><ul>
<li><a target="_blank" rel="noopener" href="https://book.douban.com/subject/25762168/">《Java核心技术》</a>。</li>
<li><a target="_blank" rel="noopener" href="https://book.douban.com/subject/3360807/">《Effective java 中文版》</a>。</li>
<li><a target="_blank" rel="noopener" href="https://book.douban.com/subject/5362860/">《Java解惑》</a>。</li>
<li><a target="_blank" rel="noopener" href="https://book.douban.com/subject/10484692/">《Java并发编程实战》</a> 。系统全面的介绍了Java的并发，如何设计支持并发的数据结构。</li>
<li><a target="_blank" rel="noopener" href="https://book.douban.com/subject/26274206/">《写给大忙人看的Java SE 8》</a></li>
<li><a target="_blank" rel="noopener" href="https://book.douban.com/subject/26587213/">《函数式编程思维》</a></li>
<li><a target="_blank" rel="noopener" href="https://book.douban.com/subject/24722612/">《深入理解Java虚拟机》</a> 。并不是那么难，Java程序员都该看看</li>
<li><a target="_blank" rel="noopener" href="https://book.douban.com/subject/25828043/">《Java性能优化权威指南》</a> 。后面的章节好像用处不大，前面有些部分还是值得看。</li>
</ul>
<h2 id="Kotlin语言"><a href="#Kotlin语言" class="headerlink" title="Kotlin语言"></a>Kotlin语言</h2><ul>
<li><a target="_blank" rel="noopener" href="https://kotlinlang.org/">Kotlin Programming Language</a>和[<a target="_blank" rel="noopener" href="https://www.kotlincn.net/">Kotlin 语言中文站</a>]。官网和对应的中文网站。</li>
<li><a target="_blank" rel="noopener" href="https://book.douban.com/subject/26916501/">《Kotlin for Android Developers》</a>。Android开发者的Kotlin入门书籍，实用性强，非常赞。</li>
<li><a target="_blank" rel="noopener" href="https://book.douban.com/subject/27093660/">《Kotlin实战》</a>。</li>
</ul>
<h2 id="计算机基础"><a href="#计算机基础" class="headerlink" title="计算机基础"></a>计算机基础</h2><ul>
<li>高教版《计算机组成原理》《深入理解计算机系统》《编码：隐匿在计算机软硬件背后的语言》 </li>
<li><a target="_blank" rel="noopener" href="https://book.douban.com/subject/26397183/">《计算机是怎样跑起来的》</a></li>
<li><a target="_blank" rel="noopener" href="https://book.douban.com/subject/26365491/">《程序是怎样跑起来的》</a></li>
<li><a target="_blank" rel="noopener" href="https://book.douban.com/subject/3351237/">《数据结构与算法 Java语言描述》</a></li>
<li><a target="_blank" rel="noopener" href="https://book.douban.com/subject/26337727/">《算法设计与分析基础》</a></li>
<li><a target="_blank" rel="noopener" href="https://book.douban.com/subject/3227098/">《编程珠玑》</a> </li>
<li><a target="_blank" rel="noopener" href="https://book.douban.com/subject/20432061/">《算法导论》</a></li>
<li>编译原理。北大出版社《编译原理》，龙书，虎书 </li>
<li>操作系统。Andrew S. Tanenbaum《现代操作系统》 </li>
<li><a target="_blank" rel="noopener" href="https://book.douban.com/subject/4889838/">《鸟哥的Linux私房菜》</a></li>
<li><a target="_blank" rel="noopener" href="https://book.douban.com/subject/6097773/">《Linux内核设计与实现》</a></li>
<li><a target="_blank" rel="noopener" href="https://book.douban.com/subject/2287506/">《深入理解LINUX内核(第三版)》</a></li>
</ul>
<h2 id="通信和网络"><a href="#通信和网络" class="headerlink" title="通信和网络"></a>通信和网络</h2><ul>
<li><a target="_blank" rel="noopener" href="https://book.douban.com/subject/26941639/">《网络是怎样连接的》</a></li>
<li><a target="_blank" rel="noopener" href="https://book.douban.com/subject/25863515/">《图解HTTP》</a></li>
<li><a target="_blank" rel="noopener" href="https://book.douban.com/subject/10746113/">《HTTP权威指南》</a></li>
<li><a target="_blank" rel="noopener" href="https://book.douban.com/subject/24737674/">《图解TCP/IP》</a></li>
<li><a target="_blank" rel="noopener" href="https://book.douban.com/subject/1088054/">《TCP/IP详解》</a></li>
<li><a target="_blank" rel="noopener" href="https://book.douban.com/subject/3519369/">《Java TCP/IP Socket编程》</a></li>
</ul>
<h2 id="工具"><a href="#工具" class="headerlink" title="工具"></a>工具</h2><ul>
<li><a target="_blank" rel="noopener" href="http://iissnan.com/progit/html/zh/ch1_0.html">Git权威指南中文手册</a></li>
</ul>
<hr>
<h1 id="软件工程"><a href="#软件工程" class="headerlink" title="软件工程"></a>软件工程</h1><h2 id="软件质量"><a href="#软件质量" class="headerlink" title="软件质量"></a>软件质量</h2><ul>
<li><a target="_blank" rel="noopener" href="https://book.douban.com/subject/10797189/">《编写可读代码的艺术》</a> （来自Google工程师，专注于代码可读性）</li>
<li><a target="_blank" rel="noopener" href="https://book.douban.com/subject/4199741/">《代码整洁之道》</a>（使用面向对象+敏捷开发原则编写清晰可维护的代码）</li>
<li><a target="_blank" rel="noopener" href="https://book.douban.com/subject/4262627/">《重构-改善既有代码的设计》</a> （学习改善已有代码）</li>
<li>《代码大全》 </li>
</ul>
<h2 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h2><ul>
<li><a target="_blank" rel="noopener" href="https://book.douban.com/subject/1239651/">《单元测试之道Java版》</a></li>
<li><a target="_blank" rel="noopener" href="https://book.douban.com/subject/25934516/">《单元测试的艺术》</a></li>
</ul>
<h2 id="设计模式"><a href="#设计模式" class="headerlink" title="设计模式"></a>设计模式</h2><ul>
<li><a target="_blank" rel="noopener" href="https://book.douban.com/subject/2334288/">《大话设计模式》</a></li>
<li><a target="_blank" rel="noopener" href="https://book.douban.com/subject/2243615/">《Head First设计模式》</a>(两本入门级的设计模式书籍)</li>
<li><a target="_blank" rel="noopener" href="https://book.douban.com/subject/1052241/">《设计模式-可复用面向对象软件的基础》</a>（设计模式在实际中的应用）</li>
</ul>
<h2 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h2><ul>
<li><a target="_blank" rel="noopener" href="https://book.douban.com/subject/1790225/">解析极限编程</a></li>
<li><a target="_blank" rel="noopener" href="https://book.douban.com/subject/4037534/">敏捷开发的艺术</a></li>
<li><a target="_blank" rel="noopener" href="http://book.douban.com/subject/5348122/">敏捷软件开发-原则、模式与实践</a></li>
<li><a target="_blank" rel="noopener" href="https://book.douban.com/subject/11614538/">程序员的是职业素养</a></li>
<li><a target="_blank" rel="noopener" href="https://book.douban.com/subject/5387402/">程序员修炼之道-从小工到专家</a></li>
<li>《像程序员一样思考》</li>
<li><a target="_blank" rel="noopener" href="https://book.douban.com/subject/6021440/">黑客与画家</a> (硅谷创业之父Paul Craham 的文集，主要介绍黑客及优秀程序员的爱好和动机)</li>
</ul>
<hr>
<h1 id="其他-1"><a href="#其他-1" class="headerlink" title="其他"></a>其他</h1><ul>
<li><a target="_blank" rel="noopener" href="https://androidweekly.io/">Android 开发技术周报</a></li>
<li><a target="_blank" rel="noopener" href="http://androidweekly.net/confirmation">AndroidWeekly</a></li>
<li><a target="_blank" rel="noopener" href="https://hencoder.com/">给高级Android工程师的进阶手册</a></li>
<li>关注微博、Twitter和Google Plus上开发高手</li>
<li>不错的个人博客: <a target="_blank" rel="noopener" href="https://keeganlee.me/">https://keeganlee.me/</a>、<a target="_blank" rel="noopener" href="http://blog.zhaiyifan.cn/%E3%80%81http://johnnyshieh.me/%E3%80%81https://blog.csdn.net/innost?t=1">http://blog.zhaiyifan.cn/、http://johnnyshieh.me/、https://blog.csdn.net/innost?t=1</a></li>
<li>系类丛书。<a target="_blank" rel="noopener" href="https://book.douban.com/series/34135?page=1">图解入门系列</a>、科普、码农系列。</li>
</ul>
<hr>
<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><ol>
<li><a target="_blank" rel="noopener" href="https://www.diycode.cc/wiki/androidbook">Android开发书籍推荐：从入门到精通系列学习路线书籍介绍</a></li>
<li><a target="_blank" rel="noopener" href="https://www.diycode.cc/topics/122">Android 学习路线图</a></li>
</ol>
<hr>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://zhangliangnbu.github.io/2018/12/17/2018-12-17-PublishToJCenter4ByGradleBintrayPlugin/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="章亮">
      <meta itemprop="description" content="Developer For Android">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="永恒的码流">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/12/17/2018-12-17-PublishToJCenter4ByGradleBintrayPlugin/" class="post-title-link" itemprop="url">项目发布-GradleBintrayPlugin</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2018-12-17 17:01:45" itemprop="dateCreated datePublished" datetime="2018-12-17T17:01:45+08:00">2018-12-17</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-06-29 14:21:42" itemprop="dateModified" datetime="2021-06-29T14:21:42+08:00">2021-06-29</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%85%B6%E4%BB%96/" itemprop="url" rel="index"><span itemprop="name">其他</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>本文介绍如何使用Bintray官方的Gradle插件<a target="_blank" rel="noopener" href="https://github.com/bintray/gradle-bintray-plugin#readme">gradle-bintray-plugin</a>发布项目到Bintray平台，并最终发布到JCenter。</p>
<p>主要参考官方的<a target="_blank" rel="noopener" href="https://github.com/bintray/gradle-bintray-plugin#readme">gradle-bintray-plugin wiki</a>和项目示例<a target="_blank" rel="noopener" href="https://github.com/bintray/bintray-examples">bintray-examples</a>。不过说实话官方wiki和示例写得都比较粗糙。</p>
<p>gradle-bintray-plugin插件在生成构件时有三种方式： Configurations, Publications and Copying files。每种方式的配置都有所不同，我们这里只说比较常见的Configurations和Publications两种方式，这也是wiki上比较推荐的方式。</p>
<p><strong>源码地址</strong>。本文涉及到的<code>nicelogger</code>项目Github地址：<a target="_blank" rel="noopener" href="https://github.com/zhangliangnbu/nice-logger">https://github.com/zhangliangnbu/nice-logger</a></p>
<hr>
<h1 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h1><p>参考上一篇文章，如果已经做了，可以跳过。默认你已经有了一个本地项目，已经创建了Bintray平台账号和Maven仓库。</p>
<p><strong>定义参数</strong></p>
<ul>
<li>Bintray平台仓库名称。<code>android</code>。</li>
<li>Bintray平台Package名称。<code>nicelogger</code>。</li>
<li>POM文件<code>groupId</code>。<code>com.liang.android</code>。</li>
<li>POM文件<code>artifactId</code>。<code>nicelogger</code>。</li>
<li>POM文件<code>version</code>。取<code>0.0.6</code>。</li>
</ul>
<p><strong>准备本地项目</strong>。有的话就不用创建。</p>
<p><strong>配置Bintray平台</strong>。创建package，如果已经有了就不用创建了。</p>
<hr>
<h1 id="使用Publications方式发布项目"><a href="#使用Publications方式发布项目" class="headerlink" title="使用Publications方式发布项目"></a>使用Publications方式发布项目</h1><p><strong>插件仓库配置</strong></p>
<p>根据wiki上的说明，<code>Gradle &gt;= 2.1</code>之后就可以不用单独配置插件仓库路径了，估计是已经包含在JCenter仓库里，我使用的是Gradle 4.6，也不用单独配置插件仓库路径。</p>
<p><strong>参数配置</strong></p>
<p>主要包括三个部分：Bintray平台参数配置、POM和构件文件参数配置、构件文件生成配置。</p>
<p>单独用一个文件<code>gradleBintrayPluginPublicationsUpload.gradle</code>维护这些配置，然后在module的<code>build.gradle</code>中引用。</p>
<p>项目<code>build.gradle</code>文件末尾添加：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apply <span class="attr">from:</span> <span class="string">&#x27;./gradleBintrayPluginPublicationsUpload.gradle&#x27;</span></span><br></pre></td></tr></table></figure>

<p><code>gradleBintrayPluginPublicationsUpload.gradle</code>配置如下：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 插件。无需另外单独配置插件仓库地址</span></span><br><span class="line">apply <span class="attr">plugin:</span> <span class="string">&#x27;maven-publish&#x27;</span></span><br><span class="line">apply <span class="attr">plugin:</span> <span class="string">&#x27;com.jfrog.bintray&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义参数</span></span><br><span class="line"><span class="keyword">def</span> gitUrl = <span class="string">&#x27;https://github.com/zhangliangnbu/nice-logger.git&#x27;</span>   <span class="comment">// Git仓库的url</span></span><br><span class="line"><span class="keyword">def</span> groupIdDefined = <span class="string">&quot;com.liang.android&quot;</span></span><br><span class="line"><span class="keyword">def</span> artifactIdDefined = <span class="string">&quot;nicelogger&quot;</span></span><br><span class="line"><span class="keyword">def</span> versionDefined = <span class="string">&quot;0.0.5&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// bintray平台信息配置</span></span><br><span class="line">Properties properties = <span class="keyword">new</span> Properties()</span><br><span class="line">properties.load(project.rootProject.file(<span class="string">&#x27;local.properties&#x27;</span>).newDataInputStream())</span><br><span class="line">bintray &#123;</span><br><span class="line">    user = properties.getProperty(<span class="string">&quot;bintray.user&quot;</span>) <span class="comment">// local.properties里设置</span></span><br><span class="line">    key = properties.getProperty(<span class="string">&quot;bintray.apikey&quot;</span>) <span class="comment">// local.properties里设置</span></span><br><span class="line">    publications = [<span class="string">&#x27;MyPublication&#x27;</span>] <span class="comment">// &#x27;MyPublication&#x27;与下面的publishing闭包里的名称对应</span></span><br><span class="line">    publish = <span class="literal">true</span> <span class="comment">// 上传后立即发布到Bintray平台</span></span><br><span class="line">    pkg &#123;</span><br><span class="line">        repo = <span class="string">&quot;android&quot;</span>  <span class="comment">// 必填。bintray平台仓库名，必须已经创建过。</span></span><br><span class="line">        name = <span class="string">&quot;nicelogger&quot;</span>  <span class="comment">// 必填。仓库里包package的名称，没有的话会自动创建。</span></span><br><span class="line">        licenses = [<span class="string">&quot;Apache-2.0&quot;</span>] <span class="comment">// 首次创建package则必须，否则选填。</span></span><br><span class="line">        vcsUrl = gitUrl <span class="comment">// 首次创建package则必须，否则选填。</span></span><br><span class="line">        version &#123;</span><br><span class="line">            name = <span class="string">&quot;$versionDefined&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 构件文件和POM信息配置</span></span><br><span class="line">publishing &#123;</span><br><span class="line">    publications &#123;</span><br><span class="line">        MyPublication(MavenPublication) &#123;</span><br><span class="line">            artifact(<span class="string">&quot;$buildDir/outputs/aar/nicelogger-release.aar&quot;</span>)</span><br><span class="line">            artifact sourcesJar</span><br><span class="line">            artifact javadocJar</span><br><span class="line">            groupId <span class="string">&quot;$groupIdDefined&quot;</span></span><br><span class="line">            artifactId <span class="string">&quot;$artifactIdDefined&quot;</span></span><br><span class="line">            version <span class="string">&quot;$versionDefined&quot;</span></span><br><span class="line">            pom.withXml &#123;</span><br><span class="line">                <span class="keyword">def</span> dependenciesNode = asNode().appendNode(<span class="string">&#x27;dependencies&#x27;</span>)</span><br><span class="line">                <span class="comment">// Iterate over the implementation dependencies (we don&#x27;t want the test ones), adding a &lt;dependency&gt; node for each</span></span><br><span class="line">                configurations.implementation.allDependencies.each &#123;</span><br><span class="line">                    <span class="comment">// Ensure dependencies such as fileTree are not included in the pom.</span></span><br><span class="line">                    <span class="keyword">if</span> (it.name != <span class="string">&#x27;unspecified&#x27;</span>) &#123;</span><br><span class="line">                        <span class="keyword">def</span> dependencyNode = dependenciesNode.appendNode(<span class="string">&#x27;dependency&#x27;</span>)</span><br><span class="line">                        dependencyNode.appendNode(<span class="string">&#x27;groupId&#x27;</span>, it.group)</span><br><span class="line">                        dependencyNode.appendNode(<span class="string">&#x27;artifactId&#x27;</span>, it.name)</span><br><span class="line">                        dependencyNode.appendNode(<span class="string">&#x27;version&#x27;</span>, it.version)</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 生成sourceJar和javaDocJar构件</span></span><br><span class="line">task sourcesJar(<span class="attr">type:</span> Jar) &#123;</span><br><span class="line">    from android.sourceSets.main.java.srcDirs</span><br><span class="line">    classifier = <span class="string">&#x27;sources&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">task javadoc(<span class="attr">type:</span> Javadoc) &#123;</span><br><span class="line">    failOnError <span class="literal">false</span></span><br><span class="line">    source = android.sourceSets.main.java.sourceFiles</span><br><span class="line">    classpath += project.files(android.getBootClasspath().join(File.pathSeparator))</span><br><span class="line">    classpath += configurations.compile</span><br><span class="line">&#125;</span><br><span class="line">task javadocJar(<span class="attr">type:</span> Jar, <span class="attr">dependsOn:</span> javadoc) &#123;</span><br><span class="line">    classifier = <span class="string">&#x27;javadoc&#x27;</span></span><br><span class="line">    from javadoc.destinationDir</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">artifacts &#123;</span><br><span class="line">    archives sourcesJar</span><br><span class="line">    archives javadocJar</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>注释里已经有说明了，补充几点如下：</p>
<ul>
<li>bintray平台信息配置。<code>user</code>和<code>key</code>是自己的私有参数，写在本地<code>local.properties</code>文件中。</li>
<li>先要生成构件文件，之后才能上传。</li>
</ul>
<p><strong>发布</strong></p>
<p>执行命令<code>./gradlew clean build bintrayUpload</code>，即可发布项目到Bintray平台，然后一键发布到JCenter。</p>
<hr>
<h1 id="使用Configurations方式发布项目"><a href="#使用Configurations方式发布项目" class="headerlink" title="使用Configurations方式发布项目"></a>使用Configurations方式发布项目</h1><p><strong>插件仓库配置</strong></p>
<p>这种方式需要用到<a target="_blank" rel="noopener" href="https://github.com/dcendents/android-maven-gradle-plugin">android-maven-gradle-plugin</a>。在工程根目录<code>build.gradle</code>中添加仓库路径：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">buildscript &#123;</span><br><span class="line">    dependencies &#123;</span><br><span class="line">        <span class="comment">// bintray plugin for configuration method</span></span><br><span class="line">        classpath <span class="string">&#x27;com.github.dcendents:android-maven-gradle-plugin:2.1&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><strong>参数配置</strong></p>
<p>主要包括三个部分：Bintray平台参数配置、POM和构件文件参数配置、构件文件生成配置。</p>
<p>单独用一个文件<code>gradleBintrayConfigurationsUpload.gradle</code>维护这些配置，然后在module的<code>build.gradle</code>中引用。</p>
<p>项目<code>build.gradle</code>文件末尾添加：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apply <span class="attr">from:</span> <span class="string">&#x27;./gradleBintrayConfigurationsUpload.gradle&#x27;</span></span><br></pre></td></tr></table></figure>

<p><code>gradleBintrayConfigurationsUpload.gradle</code>配置如下：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line">apply <span class="attr">plugin:</span> <span class="string">&#x27;com.github.dcendents.android-maven&#x27;</span></span><br><span class="line">apply <span class="attr">plugin:</span> <span class="string">&#x27;com.jfrog.bintray&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义参数</span></span><br><span class="line"><span class="keyword">def</span> gitUrl = <span class="string">&#x27;https://github.com/zhangliangnbu/nice-logger.git&#x27;</span>   <span class="comment">// Git仓库的url</span></span><br><span class="line"><span class="keyword">def</span> groupIdDefined = <span class="string">&quot;com.liang.android&quot;</span></span><br><span class="line"><span class="keyword">def</span> artifactIdDefined = <span class="string">&quot;nicelogger&quot;</span></span><br><span class="line"><span class="keyword">def</span> versionDefined = <span class="string">&quot;0.0.7&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 待发布项目的groupId和version。android-maven-gradle-plugin插件需要这么配置。</span></span><br><span class="line">group = <span class="string">&quot;$groupIdDefined&quot;</span></span><br><span class="line">version = <span class="string">&quot;$versionDefined&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// bintray平台信息配置</span></span><br><span class="line">Properties properties = <span class="keyword">new</span> Properties()</span><br><span class="line">properties.load(project.rootProject.file(<span class="string">&#x27;local.properties&#x27;</span>).newDataInputStream())</span><br><span class="line">bintray &#123;</span><br><span class="line">    user = properties.getProperty(<span class="string">&quot;bintray.user&quot;</span>) <span class="comment">// local.properties里设置</span></span><br><span class="line">    key = properties.getProperty(<span class="string">&quot;bintray.apikey&quot;</span>) <span class="comment">// local.properties里设置</span></span><br><span class="line">    configurations = [<span class="string">&#x27;archives&#x27;</span>]</span><br><span class="line">    publish = <span class="literal">true</span></span><br><span class="line">    pkg &#123;</span><br><span class="line">        repo = <span class="string">&quot;android&quot;</span>  <span class="comment">// 必填。bintray平台仓库名，必须已经创建过。</span></span><br><span class="line">        name = <span class="string">&quot;nicelogger&quot;</span>  <span class="comment">// 必填。仓库里包package的名称，没有的话会自动创建。</span></span><br><span class="line">        licenses = [<span class="string">&quot;Apache-2.0&quot;</span>] <span class="comment">// 首次创建package则必须，否则选填。</span></span><br><span class="line">        vcsUrl = gitUrl <span class="comment">// 首次创建package则必须，否则选填。</span></span><br><span class="line">        version &#123;</span><br><span class="line">            name = <span class="string">&quot;$versionDefined&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// pom文件信息配置</span></span><br><span class="line">install &#123;</span><br><span class="line">    repositories.mavenInstaller &#123;</span><br><span class="line">        pom.project &#123;</span><br><span class="line">            groupId <span class="string">&quot;$groupIdDefined&quot;</span></span><br><span class="line">            artifactId <span class="string">&quot;$artifactIdDefined&quot;</span></span><br><span class="line">            version <span class="string">&quot;$versionDefined&quot;</span></span><br><span class="line">            packaging <span class="string">&#x27;aar&#x27;</span></span><br><span class="line"></span><br><span class="line">            licenses &#123;</span><br><span class="line">                license &#123;</span><br><span class="line">                    name <span class="string">&#x27;The Apache Software License, Version 2.0&#x27;</span></span><br><span class="line">                    url <span class="string">&#x27;http://www.apache.org/licenses/LICENSE-2.0.txt&#x27;</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 生成sourceJar和javaDocJar</span></span><br><span class="line">task sourcesJar(<span class="attr">type:</span> Jar) &#123;</span><br><span class="line">    from android.sourceSets.main.java.srcDirs</span><br><span class="line">    classifier = <span class="string">&#x27;sources&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">task javadoc(<span class="attr">type:</span> Javadoc) &#123;</span><br><span class="line">    failOnError <span class="literal">false</span></span><br><span class="line">    source = android.sourceSets.main.java.sourceFiles</span><br><span class="line">    classpath += project.files(android.getBootClasspath().join(File.pathSeparator))</span><br><span class="line">    classpath += configurations.compile</span><br><span class="line">&#125;</span><br><span class="line">task javadocJar(<span class="attr">type:</span> Jar, <span class="attr">dependsOn:</span> javadoc) &#123;</span><br><span class="line">    classifier = <span class="string">&#x27;javadoc&#x27;</span></span><br><span class="line">    from javadoc.destinationDir</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">artifacts &#123;</span><br><span class="line">    archives sourcesJar</span><br><span class="line">    archives javadocJar</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 执行 ./gradlew clean bintrayUpload</span></span><br></pre></td></tr></table></figure>

<p>补充说明如下：</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/dcendents/android-maven-gradle-plugin">android-maven-gradle-plugin</a>的wiki上说需要在<code>settings.gradle</code>里配置<code>artifactId</code>,但我没有配置也发布成功了。</li>
<li>不需要单独执行构件生成任务，应该是在<code>bintrayUpload</code>中已经做了处理。</li>
</ul>
<p><strong>发布</strong></p>
<p>执行命令<code>./gradlew clean bintrayUpload</code>，即可发布项目到Bintray平台，然后一键发布到JCenter。</p>
<hr>
<h1 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h1><p>是不是感觉使用官方插件挺繁琐的？我的配置是非常精简的，选填的参数几乎没有填，看官方示例，配置真是繁琐。</p>
<p>到目前为止，已经介绍了三种发布项目到JCenter的方式，推荐使用BintrayRelease方式，配置简洁、易于维护。</p>
<hr>
<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><ol>
<li><a target="_blank" rel="noopener" href="https://github.com/bintray/gradle-bintray-plugin">gradle-bintray-plugin</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/bintray/gradle-bintray-plugin#readme">gradle-bintray-plugin wiki</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/bintray/bintray-examples">bintray-examples</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/dcendents/android-maven-gradle-plugin">android-maven-gradle-plugin</a></li>
</ol>
<hr>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://zhangliangnbu.github.io/2018/12/16/2018-12-16-PublishToJCenter3ByGradlePlugin/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="章亮">
      <meta itemprop="description" content="Developer For Android">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="永恒的码流">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/12/16/2018-12-16-PublishToJCenter3ByGradlePlugin/" class="post-title-link" itemprop="url">项目发布-BintrayRelease</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2018-12-16 22:52:56" itemprop="dateCreated datePublished" datetime="2018-12-16T22:52:56+08:00">2018-12-16</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-06-29 14:21:14" itemprop="dateModified" datetime="2021-06-29T14:21:14+08:00">2021-06-29</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%85%B6%E4%BB%96/" itemprop="url" rel="index"><span itemprop="name">其他</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>使用Gradle插件上传Android项目到Bintray平台是目前通用的做法，很方便。目前常用的Gradle插件有两个，一个是官方的<a target="_blank" rel="noopener" href="https://github.com/bintray/gradle-bintray-plugin#readme">gradle-bintray-plugin</a>，另一个是第三方开源的<a target="_blank" rel="noopener" href="https://github.com/novoda/bintray-release">bintray-release</a>。既然官方已经发布了自己的Gradle插件，那为什么还有人发布另外一个呢？可能因为官方自己的插件使用起来比较繁琐吧。</p>
<p>这篇文章简要介绍如何使用<a target="_blank" rel="noopener" href="https://github.com/novoda/bintray-release">bintray-release</a>发布Android项目到Bintray，并最终发布到JCenter。</p>
<p>bintray-release使用起来非常简单，具体详情请见<a target="_blank" rel="noopener" href="https://github.com/novoda/bintray-release/wiki">bintray-release wiki</a>。</p>
<p><strong>源码地址</strong>。本文涉及到的<code>nicelogger</code>项目Github地址：<a target="_blank" rel="noopener" href="https://github.com/zhangliangnbu/nice-logger">https://github.com/zhangliangnbu/nice-logger</a></p>
<hr>
<h1 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h1><p>参考上一篇文章，如果已经做了，可以跳过。默认你已经有了一个本地项目，已经创建了Bintray平台账号和Maven仓库。</p>
<p><strong>定义参数</strong></p>
<ul>
<li>Bintray平台仓库名称。<code>android</code>。</li>
<li>Bintray平台Package名称。<code>nicelogger</code>。</li>
<li>POM文件<code>groupId</code>。<code>com.liang.android</code>。</li>
<li>POM文件<code>artifactId</code>。<code>nicelogger</code>。</li>
<li>POM文件<code>version</code>。取<code>0.0.3</code>。</li>
</ul>
<p><strong>准备本地项目</strong>。有的话就不用创建。</p>
<p><strong>配置Bintray平台</strong>。创建package，如果已经有了就不用创建了。</p>
<hr>
<h1 id="发布到Bintray"><a href="#发布到Bintray" class="headerlink" title="发布到Bintray"></a>发布到Bintray</h1><p>这一步使用插件，做如下工作：</p>
<ul>
<li>在本地生成构件文件。</li>
<li>在Bintray平台创建版本。</li>
<li>上传文件到Bintray平台。</li>
<li>发布到Bintray平台仓库中。</li>
</ul>
<p>具体使用请见<a target="_blank" rel="noopener" href="https://github.com/novoda/bintray-release/wiki">bintray-release wiki</a>，我的配置与wiki略有差异，本质上是一样的。</p>
<p>一，在工程目录<code>build.gradle</code>中添加插件地址，其中版本号请用最新的：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">buildscript &#123;</span><br><span class="line">    dependencies &#123;</span><br><span class="line">        <span class="comment">// A helper for releasing from gradle up to bintray</span></span><br><span class="line">        classpath <span class="string">&#x27;com.novoda:bintray-release:0.9&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>二，在<code>nicelogger</code>module目录<code>build.gradle</code>中添加参数配置：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">apply <span class="attr">plugin:</span> <span class="string">&#x27;com.novoda.bintray-release&#x27;</span></span><br><span class="line"></span><br><span class="line">publish &#123;</span><br><span class="line">    userOrg = <span class="string">&#x27;zhangliang&#x27;</span></span><br><span class="line">    repoName = <span class="string">&#x27;android&#x27;</span></span><br><span class="line">    groupId = <span class="string">&#x27;com.liang.android&#x27;</span></span><br><span class="line">    artifactId = <span class="string">&#x27;nicelogger&#x27;</span></span><br><span class="line">    publishVersion = <span class="string">&#x27;0.0.3&#x27;</span></span><br><span class="line">    uploadName = <span class="string">&#x27;nicelogger&#x27;</span></span><br><span class="line">    desc = <span class="string">&#x27;Oh hi, this is a nice description for nicelogger, right?&#x27;</span></span><br><span class="line">    website = <span class="string">&#x27;https://github.com/zhangliangnbu/nice-logger&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>可以在module目录中创建<code>bintrayReleaseUpload.gradle</code>文件，并将上述参数配置写入其中，然后在module目录<code>build.gradle</code>中通过<code>apply from: &#39;./bintrayReleaseUpload.gradle&#39;</code>引入。这样做便于管理。</p>
</blockquote>
<p>三，执行上传任务</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./gradlew clean build bintrayUpload -PbintrayUser=BINTRAY_USERNAME -PbintrayKey=BINTRAY_KEY -PdryRun=<span class="literal">false</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>BINTRAY_USERNAME和BINTRAY_KEY填写自己的。</p>
</blockquote>
<p>上传完后，即可在Bintray平台<code>nicelogger</code>包下看到发布的<code>0.0.3</code>版本。</p>
<p>从Bintray仓库发布到JCenter操作较简单，见上篇文章。</p>
<hr>
<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><ol>
<li><a target="_blank" rel="noopener" href="https://github.com/novoda/bintray-release">bintray-release</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/novoda/bintray-release/wiki">bintray-release wiki</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/novoda/bintray-release/wiki/%E4%B8%AD%E6%96%87%E6%96%87%E6%A1%A3HOME">bintray-release中文文档</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/bintray/gradle-bintray-plugin#readme">gradle-bintray-plugin</a></li>
</ol>
<hr>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://zhangliangnbu.github.io/2018/12/15/2018-12-15-PublishToJCenter2ByUI/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="章亮">
      <meta itemprop="description" content="Developer For Android">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="永恒的码流">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/12/15/2018-12-15-PublishToJCenter2ByUI/" class="post-title-link" itemprop="url">项目发布-手动</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2018-12-15 21:09:18" itemprop="dateCreated datePublished" datetime="2018-12-15T21:09:18+08:00">2018-12-15</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-06-29 14:21:01" itemprop="dateModified" datetime="2021-06-29T14:21:01+08:00">2021-06-29</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%85%B6%E4%BB%96/" itemprop="url" rel="index"><span itemprop="name">其他</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>本文主要说明如何生成项目构件，并手动上传构件文件到Bintray平台，最后发布到JCenter仓库这一流程。</p>
<p><strong>发布流程</strong>。参考上一篇文章，完整发布流程如下：</p>
<ol>
<li>准备工作。定义参数；准备本地待发布项目；配置Bintray平台账号、仓库、Package、版本。</li>
<li>生成构件文件。本地生成待发布的构件文件(包括POM文件)。</li>
<li>发布到Bintray。上传和发布本地构件文件到Bintray平台。</li>
<li>发布到JCenter。发布Bintray平台上的项目到JCenter。</li>
</ol>
<p><strong>源码地址</strong>。本文涉及到的<code>nicelogger</code>项目Github地址：<a target="_blank" rel="noopener" href="https://github.com/zhangliangnbu/nice-logger">https://github.com/zhangliangnbu/nice-logger</a></p>
<hr>
<h1 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h1><p>参考上一篇文章，如果已经做了，可以跳过。默认你已经有了一个本地项目，已经创建了Bintray平台账号和Maven仓库。</p>
<p><strong>定义参数</strong></p>
<ul>
<li>Bintray平台仓库名称。<code>android</code>。</li>
<li>Bintray平台Package名称。<code>nicelogger</code>。</li>
<li>POM文件<code>groupId</code>。<code>com.liang.android</code>。</li>
<li>POM文件<code>artifactId</code>。<code>nicelogger</code>。</li>
<li>POM文件<code>version</code>。取<code>0.0.1</code>。</li>
</ul>
<p><strong>准备本地项目</strong>。略。</p>
<p><strong>配置Bintray平台</strong>。根据参数创建Package和版本。</p>
<br>

<hr>
<h1 id="生成构件"><a href="#生成构件" class="headerlink" title="生成构件"></a>生成构件</h1><p>生成需要上传到Maven库的四个文件：</p>
<ul>
<li><code>nicelogger-0.0.1.aar</code></li>
<li><code>nicelogger-0.0.1-sources.jar</code></li>
<li><code>nicelogger-0.0.1-javadoc.jar</code></li>
<li><code>nicelogger-0.0.1.pom</code></li>
</ul>
<p><strong>生成<code>nicelogger-0.0.1.aar</code>文件</strong></p>
<p>在<code>nicelogger</code>的<code>build.gradle</code>最后中添加如下代码，用于重命名生成的aar文件：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 定义pom文件参数</span></span><br><span class="line"><span class="keyword">def</span> groupIdDefined = <span class="string">&quot;com.liang.android&quot;</span></span><br><span class="line"><span class="keyword">def</span> artifactIdDefined = <span class="string">&quot;nicelogger&quot;</span></span><br><span class="line"><span class="keyword">def</span> versionDefined = <span class="string">&quot;0.0.1&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 重命名生成的arr文件</span></span><br><span class="line">android.libraryVariants.all &#123; variant -&gt;</span><br><span class="line">    variant.outputs.all &#123; output -&gt;</span><br><span class="line">        <span class="keyword">if</span> (outputFile != <span class="literal">null</span> &amp;&amp; outputFileName.endsWith(<span class="string">&#x27;.aar&#x27;</span>)) &#123;</span><br><span class="line">            outputFileName = <span class="string">&quot;$&#123;artifactIdDefined&#125;-$&#123;versionDefined&#125;.aar&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>执行<code>./gradlew nicelogger:assembleRelease</code>生成arr文件，位于<code>library/build/outputs/aar/</code>中。</p>
<p><strong>生成<code>nicelogger-0.0.1-sources.jar</code>文件</strong></p>
<p>接着在<code>nicelogger</code>的<code>build.gradle</code>最后添加如下代码，建立生成所需文件的任务</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 生成Java源码文件</span></span><br><span class="line">task sourcesJar(<span class="attr">type:</span> Jar) &#123;</span><br><span class="line">    from android.sourceSets.main.java.srcDirs</span><br><span class="line">    baseName = <span class="string">&quot;$&#123;artifactIdDefined&#125;-$&#123;versionDefined&#125;&quot;</span></span><br><span class="line">    classifier = <span class="string">&#x27;sources&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>然后执行<code>./gradlew nicelogger:sourcesJar</code>，就可以生成Java源码文件，位于<code>nicelogger/build/libs/</code>中。</p>
<p><strong>生成<code>nicelogger-0.0.1-javadoc.jar</code>文件</strong></p>
<p>接着在<code>nicelogger</code>的<code>build.gradle</code>最后添加如下代码，建立生成所需文件的任务</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 生成Javadoc文件</span></span><br><span class="line">task javadoc(<span class="attr">type:</span> Javadoc) &#123;</span><br><span class="line">    failOnError <span class="literal">false</span></span><br><span class="line">    source = android.sourceSets.main.java.sourceFiles</span><br><span class="line">    classpath += project.files(android.getBootClasspath().join(File.pathSeparator))</span><br><span class="line">    classpath += configurations.compile</span><br><span class="line">&#125;</span><br><span class="line">task javadocJar(<span class="attr">type:</span> Jar, <span class="attr">dependsOn:</span> javadoc) &#123;</span><br><span class="line">    baseName = <span class="string">&quot;$&#123;artifactIdDefined&#125;-$&#123;versionDefined&#125;&quot;</span></span><br><span class="line">    classifier = <span class="string">&#x27;javadoc&#x27;</span></span><br><span class="line">    from javadoc.destinationDir</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>然后执行<code>./gradlew nicelogger:javadocJar</code>，就可以生成Javadoc文件，位于<code>nicelogger/build/libs/</code>中。</p>
<p><strong>生成<code>nicelogger-0.0.1.pom</code>文件</strong></p>
<p>有两种方式创建POM文件：</p>
<p>一，参考<a target="_blank" rel="noopener" href="http://maven.apache.org/pom.html">POM Reference</a>手动创建POM文件，填入相关参数。</p>
<p>二，使用<a target="_blank" rel="noopener" href="https://docs.gradle.org/current/userguide/maven_plugin.html">Gradle Maven Plugin</a>生成POM，接着在<code>nicelogger</code>的<code>build.gradle</code>最后中添加如下代码</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 生成pom文件</span></span><br><span class="line">apply <span class="attr">plugin:</span> <span class="string">&#x27;maven&#x27;</span></span><br><span class="line"></span><br><span class="line">task createPom &#123;</span><br><span class="line">    doLast &#123;</span><br><span class="line">        pom &#123;</span><br><span class="line">            project &#123;</span><br><span class="line">                groupId <span class="string">&quot;$&#123;groupIdDefined&#125;&quot;</span></span><br><span class="line">                artifactId <span class="string">&quot;$&#123;artifactIdDefined&#125;&quot;</span></span><br><span class="line">                version <span class="string">&quot;$&#123;versionDefined&#125;&quot;</span></span><br><span class="line">                packaging <span class="string">&quot;aar&quot;</span></span><br><span class="line">                licenses &#123;</span><br><span class="line">                    license &#123;</span><br><span class="line">                        name <span class="string">&#x27;The Apache Software License, Version 2.0&#x27;</span></span><br><span class="line">                        url <span class="string">&#x27;http://www.apache.org/licenses/LICENSE-2.0.txt&#x27;</span></span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;.writeTo(<span class="string">&quot;$libsDir/$&#123;artifactIdDefined&#125;-$&#123;versionDefined&#125;.pom&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>后执行<code>./gradlew nicelogger:createPom</code>，就可以生成所需的POM文件，位于<code>nicelogger/build/libs/</code>中，内容如下：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.liang.android<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>nicelogger<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.0.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">packaging</span>&gt;</span>aar<span class="tag">&lt;/<span class="name">packaging</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">licenses</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">license</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">name</span>&gt;</span>The Apache Software License, Version 2.0<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">url</span>&gt;</span>http://www.apache.org/licenses/LICENSE-2.0.txt<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">license</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">licenses</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>生成四个文件后，可以把它们放在一个文件夹里，方面之后的上传操作。</p>
<hr>
<h1 id="发布到Bintray"><a href="#发布到Bintray" class="headerlink" title="发布到Bintray"></a>发布到Bintray</h1><p><strong>上传文件</strong></p>
<ul>
<li>进入上传文件页。在Bintray官网上，进入<code>&#123;usrname&#125;/android/nicelogger/0.0.1</code>版本页，点击“Upload Files”进入上传文件页。</li>
<li>上传文件。点击“Click to Add Files” 上传四个文件， “Target Repository Path”填<code>com/liang/android/nicelogger/0.0.1</code>，一般上传了POM文件后，就会有提示。然后点击“Save Changes”即可。</li>
</ul>
<blockquote>
<p>Target Repository Path为{groupId}/{artifactId}/{version}，其中“.”都需要替换为“/”。</p>
</blockquote>
<p><strong>发布到Bintray仓库</strong></p>
<p>上传文件完成后，会提示如何处理文件：“Discard”还是“Publish”。选择“Publish”，就会发布文件到Bintray平台的Maven仓库，这样我们就能解析，只不过要带上用户自己的仓库地址而已。</p>
<blockquote>
<p>发布到Bintray仓库后，会自动生成<code>maven-metadata.xml</code>文件。</p>
</blockquote>
<p>用户Bintray仓库地址。发布后的项目在<code>https://dl.bintray.com/&#123;username&#125;/&#123;repository_name&#125;</code>下可查看，我刚才发布的项目在<code>https://dl.bintray.com/zhangliang/android/com/liang/android/nicelogger/</code>。</p>
<p><strong>Bintray仓库依赖解析</strong></p>
<p>Gradle项目使用<code>nicelogger</code>依赖方式如下：</p>
<p>一，添加仓库地址。</p>
<p>在需要此依赖的项目<code>build.gradle</code>配置仓库地址：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">repositories &#123;</span><br><span class="line">    maven &#123;</span><br><span class="line">        url <span class="string">&quot;https://dl.bintray.com/zhangliang/android&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>或工程目录<code>build.gradle</code>下添加配置：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">allprojects &#123;</span><br><span class="line">    repositories &#123;</span><br><span class="line">        maven &#123;</span><br><span class="line">            url <span class="string">&quot;https://dl.bintray.com/zhangliang/android&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>二，添加依赖。在项目<code>build.gradle</code>配置依赖</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">dependencies &#123;</span><br><span class="line">    implementation <span class="string">&#x27;com.liang.android:nicelogger:0.0.1&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<hr>
<h1 id="发布到JCenter"><a href="#发布到JCenter" class="headerlink" title="发布到JCenter"></a>发布到JCenter</h1><p>进入<code>nicelogger</code>的package页面，点击“Add to JCenter”，进入下一页，点击“Send”即可。</p>
<p>发布到JCenter仓库需要审核，主要审核文件格式是否符合规范和以及名称是否唯一等，没有问题的话，一般一个工作日以内都会通过。通过后，可以直接用jcenter作为仓库地址，无需配置用户自己的Bintray仓库地址。</p>
<p>JCenter仓库地址。<code>http://jcenter.bintray.com/&#123;地址化的groupId&#125;</code>，<code>地址化的groupId</code>即用“/”代替“.”。</p>
<p>具体详情请见用户指南<a target="_blank" rel="noopener" href="https://www.jfrog.com/confluence/display/BT/Central+Repositories#CentralRepositories-JCenter">发布到JCenter</a>。</p>
<p><strong>可能遇到的问题</strong></p>
<p>一，点击“Add to JCenter”报错：</p>
<blockquote>
<p>Please fix the following before submitting a JCenter inclusion request: the POM is invalid or was uploaded to the wrong coordinates</p>
</blockquote>
<p>我之前是因为文件名不一致才出现这个错误提示。必须为<code>&#123;artifactId&#125;-&#123;version&#125;xxx</code>等。</p>
<p>终于写完了一个完整的流程，O(∩_∩)O。</p>
<hr>
<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><ol>
<li><a target="_blank" rel="noopener" href="https://bintray.com/">Bintray官网</a></li>
<li><a target="_blank" rel="noopener" href="https://jcenter.bintray.com/">JCenter仓库</a></li>
<li><a target="_blank" rel="noopener" href="https://www.jfrog.com/confluence/display/BT/Introduction">JFrog用户指南</a></li>
</ol>
<hr>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://zhangliangnbu.github.io/2018/12/13/2018-12-13-PublishToJCenter1Base/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="章亮">
      <meta itemprop="description" content="Developer For Android">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="永恒的码流">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/12/13/2018-12-13-PublishToJCenter1Base/" class="post-title-link" itemprop="url">项目发布-基础</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2018-12-13 09:42:50" itemprop="dateCreated datePublished" datetime="2018-12-13T09:42:50+08:00">2018-12-13</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-06-29 14:20:47" itemprop="dateModified" datetime="2021-06-29T14:20:47+08:00">2021-06-29</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%85%B6%E4%BB%96/" itemprop="url" rel="index"><span itemprop="name">其他</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p><strong>发布项目的定义</strong>。发布项目到远程JCenter仓库，准确的说是发布项目构件到JCenter仓库，用英语说是<em>Publishing artifacts to the JCenter</em>。本文所说的发布项目都是指发布项目构建后的生成物，即构件(Artifacts)。</p>
<p><strong>简介</strong>。JCenter是JFrog公司旗下Bintray平台上一个公开的Java仓库。要发布项目到JCenter，首先需要发布项目到Bintray平台，然后才能发布到它的公开库——JCenter。</p>
<ul>
<li>Bintray官网： <a target="_blank" rel="noopener" href="https://bintray.com/">https://bintray.com/</a></li>
<li>JCenter仓库地址：<a target="_blank" rel="noopener" href="https://jcenter.bintray.com/">https://jcenter.bintray.com/</a></li>
</ul>
<p>Bintray平台上可以托管多种类型的库，如比较流行的Maven和npm。</p>
<p><strong>本文写作目的</strong>。本文目的是介绍如何上传Android Library项目构件到Bintray Maven库，并最终发布到JCenter这一整个流程。其实关于发布项目到JCenter这方面的介绍，网上已经有许多文章了，官网也有用户指南，那为什么我还有写这篇文章呢？</p>
<ul>
<li>博客介绍不全。一般博客只是介绍如何使用Gradle插件如<em>gradle-bintray-plugin</em>等上传项目Artifacts，但参数为什么要那样配置？上传失败如何定位问题？等等都没有介绍。如果不使用插件，又该如何做？</li>
<li>官方用户指南较凌乱。</li>
</ul>
<p><strong>源码地址</strong>。本文涉及到的<code>nicelogger</code>项目Github地址：<a target="_blank" rel="noopener" href="https://github.com/zhangliangnbu/nice-logger">https://github.com/zhangliangnbu/nice-logger</a></p>
<hr>
<h1 id="Maven相关"><a href="#Maven相关" class="headerlink" title="Maven相关"></a>Maven相关</h1><p>详细介绍请见<a target="_blank" rel="noopener" href="https://maven.apache.org/index.html">Apach Maven</a>。简单讲，Maven就是项目构建和管理的工具，Maven仓库就是利用Maven来管理项目的仓库。</p>
<p><strong>Maven仓库文件规范</strong></p>
<p>上传文件到Maven仓库有一定的规范。</p>
<p>对于Android项目，必须上传的文件包括：</p>
<ul>
<li><code>.aar</code>文件。<a target="_blank" rel="noopener" href="https://developer.android.com/studio/projects/android-library">Android ARchive</a>，Android构件特有文件，类似于<code>.jar</code>文件<a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/JAR_(file_format)">Java ARchive</a>，但包含一些资源文件。</li>
<li><code>.pom</code>文件。Maven仓库中必须有的文件，XML格式，包含项目的所有信息，详情请见<a target="_blank" rel="noopener" href="https://maven.apache.org/pom.html">POM Reference</a>。</li>
</ul>
<p>有些Maven仓库审核比较严格，需要上传另外的两个文件：</p>
<ul>
<li><code>-sources.jar</code>文件。Java源码文件。</li>
<li><code>-javadoc.jar</code>文件。Java文档文件。</li>
</ul>
<p><strong>POM文件</strong></p>
<p>有四个必填的参数，以著名的<a target="_blank" rel="noopener" href="http://square.github.io/okhttp/">OkHttp项目</a>作为示例进行说明如下：</p>
<ol>
<li><code>modelVersion</code>。<code>POM</code>版本，一般都写<code>4.0.0</code>，支持Maven 2和3。</li>
<li><code>groupId</code>。项目所在的项目组标识，如OkHttp所在的项目组标识是<code>com.squareup.okhttp3</code>。</li>
<li><code>artifactId</code>。项目的标识，如<code>okhttp</code>。</li>
<li><code>version</code>。项目当前版本号，如OkHttp项目的<code>3.12.0</code>。</li>
</ol>
<p>另外还有一个参数<code>packaging</code>，对于Android项目来一般不能缺少，它表示打包方式，默认是<code>jar</code>，Android项目一般为<code>aar</code>。</p>
<blockquote>
<p>我们用Gradle解析依赖的时候，会这样写：<code>implementation &#39;com.squareup.okhttp3:okhttp:3.12.0&#39;</code>，其中<code>com.squareup.okhttp3</code>就是当前依赖的<code>groupId</code>，<code>okhttp</code>是依赖的<code>artifactId</code>,<code>3.12.0</code>是当前要解析的版本<code>version</code>。</p>
<p>注意：<code>groupId</code>、<code>artifactId</code>和<code>version</code>都是非常重要的参数，在上传文件之前必须先定义好，在之后的过程中会用到。</p>
</blockquote>
<p>Android项目基本<code>POM</code>文件如下：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0</span></span></span><br><span class="line"><span class="string"><span class="tag">                      http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.squareup.okhttp3<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>okhttp<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.12.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">packaging</span>&gt;</span>aar<span class="tag">&lt;/<span class="name">packaging</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p><strong>文件名统一</strong></p>
<p>发布到JCenter里的四个文件名称必须统一如下：</p>
<ul>
<li><code>&#123;artifactId&#125;-&#123;version&#125;.aar</code></li>
<li><code>&#123;artifactId&#125;-&#123;version&#125;-sources.jar</code></li>
<li><code>&#123;artifactId&#125;-&#123;version&#125;-javadoc.jar</code></li>
<li><code>&#123;artifactId&#125;-&#123;version&#125;.pom</code></li>
</ul>
<hr>
<h1 id="用户手册"><a href="#用户手册" class="headerlink" title="用户手册"></a>用户手册</h1><p>见<a target="_blank" rel="noopener" href="https://www.jfrog.com/confluence/display/BT/Introduction">JFrog用户指南</a>。里面详细介绍各种概念、使用、操作等。浏览一遍即可，有许多是用不上的。主要章节如下：</p>
<ul>
<li>了解核心概念：仓库、包和版本。见章节：<a target="_blank" rel="noopener" href="https://www.jfrog.com/confluence/display/BT/Key+Concepts">Key Concepts</a>。</li>
<li>了解发布的三个步骤：创建版本、上传、发布。见章节：<a target="_blank" rel="noopener" href="https://www.jfrog.com/confluence/display/BT/Uploading">Uploading</a>、<a target="_blank" rel="noopener" href="https://www.jfrog.com/confluence/display/BT/Uploads">Uploads</a></li>
<li>了解上传的方法：UI手动、cURL、Maven、Gradle。见章节：<a target="_blank" rel="noopener" href="https://www.jfrog.com/confluence/display/BT/Maven+Repositories">Maven Repositories</a></li>
</ul>
<blockquote>
<p>任何个人博客和文章都不能代替官方用户手册，这是必须要读的，它应当是一切非官方文档的参考。</p>
</blockquote>
<hr>
<h1 id="发布流程"><a href="#发布流程" class="headerlink" title="发布流程"></a>发布流程</h1><p>一般发布流程如下：</p>
<ol>
<li>准备工作。定义参数；准备本地待发布项目；配置Bintray平台账号、仓库、Package、版本。</li>
<li>生成构件文件。本地生成待发布的构件文件(包括POM文件)。</li>
<li>发布到Bintray。上传和发布本地构件文件到Bintray平台。</li>
<li>发布到JCenter。发布Bintray平台上的项目到JCenter。</li>
</ol>
<br>

<hr>
<h1 id="发布方式"><a href="#发布方式" class="headerlink" title="发布方式"></a>发布方式</h1><p>发布项目到JCenter有许多方式：</p>
<ol>
<li>UI手动上传。通过Bintray网站UI，手动上传项目构件文件。</li>
<li>cURL上传。通过cURL调用REST API接口上传。</li>
<li>Maven上传。使用Maven客户端上传项目构件文件到Bintray平台的maven仓库。</li>
<li>Gradle插件上传。通<a target="_blank" rel="noopener" href="https://github.com/bintray/gradle-bintray-plugin#readme">gradle-bintray-plugin</a>和<a target="_blank" rel="noopener" href="https://github.com/novoda/bintray-release">bintray-release</a>等Gradle插件上传。</li>
</ol>
<p>不同的方式会导致发布流程略微有所不同，有些操作可以合并在一起。比如Gradle插件上传方式中，创建pacakge、版本、创建构件文件和上传操作可以一起执行。</p>
<br>

<hr>
<h1 id="准备工作说明"><a href="#准备工作说明" class="headerlink" title="准备工作说明"></a>准备工作说明</h1><p>主要描述定义参数、准备本地项目和配置Bintray平台这三步操作。</p>
<p><strong>定义参数</strong></p>
<ul>
<li>Bintray平台仓库名称。你要发布到哪个仓库，当然要知道它的名称了。我这里是<code>android</code>。</li>
<li>Bintray平台Package名称。没有规定，我这里取为<code>nicelogger</code>。</li>
<li>POM文件<code>groupId</code>。没有规定，一般为<code>xxx.xxx.xxx</code>，我这里取<code>com.liang.android</code>。</li>
<li>POM文件<code>artifactId</code>。没有规定，我这里取<code>nicelogger</code>。</li>
<li>POM文件<code>version</code>。版本号，我这里取<code>0.0.1</code>，作为第一个版本。</li>
</ul>
<blockquote>
<p>注意：Bintray平台Package名称和POM文件<code>artifactId</code>不必取相同的名称，可以不一致。为了方便说明和记忆，我取为一致。</p>
</blockquote>
<p><strong>准备项目</strong></p>
<p>可以创建一个然后发布到GitHub或者从GitHub fork一个。为了描述方便工程名称为<code>NiceLoggerDemo</code>, Library Module名称为<code>nicelogger</code>。</p>
<p>项目的GitHub地址在之后的配置中，需要用到。</p>
<p><strong>配置Bintray平台</strong></p>
<ul>
<li>创建账户。如果已经有账户了，就不用创建。在<a target="_blank" rel="noopener" href="https://bintray.com/">Bintray官网</a>注册账号，参考<a target="_blank" rel="noopener" href="https://www.jfrog.com/confluence/display/BT/Getting+Started">官网指南-Creating an Account</a>。</li>
<li>创建Maven库。如果已经创建过Maven仓库，可以不用创建。进入个人中心主页，点击“Add New Repository”，进入填写仓库信息页。填写信息：“Name”，看其他博客许多人写了“maven”，我写了“android”，表示是一个用于存储Android项目的Maven仓库，这个名字需要记住，以后使用Gradle插件上传项目的时候用得着。“Type”选择“Maven”。其他选填。点击“Create”就可以创建一个Maven仓库了。</li>
<li>创建Package。用Gradle插件方式时可以不用手动创建。进入Maven仓库，点击“Add New Package”，进入仓库信息填写页。信息填写：“Name”填之前规定的<code>nicelogger</code>，“Version control”填你上传到Github上的项目地址，其他选填。点击“Create Package”即可。</li>
<li>创建版本。用Gradle插件方式时可以不用手动创建。从Package页面进入“Create New Version”页面，“Name”填写定义好的<code>0.0.1</code>，其他选填，点击“Create Version”即可。</li>
</ul>
<p>准备工作做好后，接下来就可以通过不同的方式进行后续操作了。</p>
<br>

<hr>
<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><ol>
<li><a target="_blank" rel="noopener" href="https://www.geekhub.cn/a/1295.html">JCenter是什么</a></li>
<li><a target="_blank" rel="noopener" href="https://bintray.com/">Bintray官网</a></li>
<li><a target="_blank" rel="noopener" href="https://jcenter.bintray.com/">JCenter仓库</a></li>
<li><a target="_blank" rel="noopener" href="https://www.jfrog.com/confluence/display/BT/Introduction">JFrog用户指南</a></li>
<li><a target="_blank" rel="noopener" href="https://maven.apache.org/index.html">Apach Maven</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/novoda/bintray-release">bintray-release</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/bintray/gradle-bintray-plugin#readme">使用Gradle插件上传Artifacts到Bintrary</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/bintray/bintray-examples/tree/master/gradle-bintray-plugin-examples">使用Gradle插件上传示例</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/xiangzhihong8/article/details/53869957">博客-上传Gradle项目到Maven仓库</a></li>
<li><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/905411bf4f8f">从Travis到Bintray</a></li>
</ol>
<br>

<hr>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://zhangliangnbu.github.io/2018/12/08/2018-12-08-ZeroCICEPreliminaryUse/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="章亮">
      <meta itemprop="description" content="Developer For Android">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="永恒的码流">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/12/08/2018-12-08-ZeroCICEPreliminaryUse/" class="post-title-link" itemprop="url">ZeroCICE使用初步</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2018-12-08 22:25:42" itemprop="dateCreated datePublished" datetime="2018-12-08T22:25:42+08:00">2018-12-08</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-06-29 14:20:15" itemprop="dateModified" datetime="2021-06-29T14:20:15+08:00">2021-06-29</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%85%B6%E4%BB%96/" itemprop="url" rel="index"><span itemprop="name">其他</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h1><p>最近编译一个行情Android APP，里面使用到<a target="_blank" rel="noopener" href="https://zeroc.com/">ZeroC ICE</a>工具，将ice文件转换成Java文件(当然不止于此)。初次使用，做一点总结。</p>
<br>

<h1 id="macOS上安装"><a href="#macOS上安装" class="headerlink" title="macOS上安装"></a>macOS上安装</h1><p><a target="_blank" rel="noopener" href="https://zeroc.com/downloads/ice#macos">利用homebrew安装最新版本</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install ice</span><br></pre></td></tr></table></figure>
<p>由于要编译的代码很老旧，使用的ice需要3.6.3版本的，但我根据官网文档，只能安装3.6.4的，最后也能跑的通</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">brew uninstall ice // 首先卸载之前最新版本</span><br><span class="line">brew install zeroc-ice/tap/ice@3.6 // ice</span><br><span class="line">brew install zeroc-ice/tap/icetouch@3.6  //ice touch  是为iphone和ipod touch开发的版本，开发Android的话可以不用安装</span><br></pre></td></tr></table></figure>
<br>

<h1 id="Android项目配置"><a href="#Android项目配置" class="headerlink" title="Android项目配置"></a>Android项目配置</h1><p><a target="_blank" rel="noopener" href="https://doc.zeroc.com/ice/3.7/release-notes/using-ice-on-android">具体可以见官网 using-ice-on-android</a><br>我自己的相关配置如下</p>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 项目根目录gradle文件</span></span><br><span class="line"><span class="keyword">buildscript</span> &#123;</span><br><span class="line">    <span class="keyword">repositories</span> &#123;</span><br><span class="line">        google()</span><br><span class="line">        jcenter()</span><br><span class="line">        maven &#123;</span><br><span class="line">            url <span class="string">&#x27;https://repo.zeroc.com/nexus/content/repositories/releases&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">dependencies</span> &#123;</span><br><span class="line">        <span class="keyword">classpath</span> <span class="string">&#x27;com.android.tools.build:gradle:3.1.2&#x27;</span></span><br><span class="line">        <span class="keyword">classpath</span> <span class="keyword">group</span>: <span class="string">&#x27;com.zeroc.gradle.ice-builder&#x27;</span>, name: <span class="string">&#x27;slice&#x27;</span>, version: <span class="string">&#x27;1.3.14&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">allprojects</span> &#123;</span><br><span class="line">    <span class="keyword">repositories</span> &#123;</span><br><span class="line">        google()</span><br><span class="line">        jcenter()</span><br><span class="line">        maven &#123;</span><br><span class="line">            url <span class="string">&#x27;https://repo.zeroc.com/nexus/content/repositories/releases&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">task</span> clean(type: <span class="keyword">Delete</span>) &#123;</span><br><span class="line">    <span class="keyword">delete</span> rootProject.buildDir</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<br>

<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 应用的gradle文件</span></span><br><span class="line">apply plugin: <span class="string">&#x27;com.android.application&#x27;</span></span><br><span class="line">apply plugin: <span class="string">&#x27;slice&#x27;</span></span><br><span class="line">slice &#123;</span><br><span class="line">    java &#123;</span><br><span class="line">        srcDir = <span class="string">&#x27;.&#x27;</span></span><br><span class="line">        <span class="comment">// 这是ice文件中需要引入的文件，可以拉出来放在工程目录，我这里图方便就这样写了</span></span><br><span class="line">        <span class="keyword">include</span> = [<span class="string">&quot;/usr/local/Cellar/ice@3.6/3.6.4_1/share/Ice-3.6.4/slice/&quot;</span>] </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 这是ice文件转成Java文件后的输出目录</span></span><br><span class="line"><span class="keyword">project</span>.slice.output = <span class="keyword">project</span>.<span class="keyword">file</span>(<span class="string">&quot;$&#123;project.buildDir&#125;/generated/source/ice&quot;</span>)</span><br><span class="line"></span><br><span class="line">android &#123;</span><br><span class="line">    compileSdkVersion <span class="number">27</span></span><br><span class="line">    defaultConfig &#123;</span><br><span class="line">        applicationId <span class="string">&quot;com.slm.tradeclient&quot;</span></span><br><span class="line">        minSdkVersion <span class="number">16</span></span><br><span class="line">        targetSdkVersion <span class="number">27</span></span><br><span class="line">        versionCode <span class="number">1</span></span><br><span class="line">        versionName <span class="string">&quot;1.0&quot;</span></span><br><span class="line">        testInstrumentationRunner <span class="string">&quot;android.support.test.runner.AndroidJUnitRunner&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">sourceSets</span> &#123;</span><br><span class="line">        main &#123;</span><br><span class="line">            java &#123;</span><br><span class="line">                <span class="comment">// 这是ice文件的源目录，也就是把这个目录里的ice文件转成Java文件</span></span><br><span class="line">                srcDirs = [<span class="string">&#x27;src/main/java&#x27;</span>, <span class="keyword">project</span>.slice.output]</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    buildTypes &#123;</span><br><span class="line">        debug &#123;</span><br><span class="line">            debuggable <span class="keyword">true</span></span><br><span class="line">        &#125;</span><br><span class="line">        release &#123;</span><br><span class="line">            minifyEnabled <span class="keyword">false</span></span><br><span class="line">            proguardFiles getDefaultProguardFile(<span class="string">&#x27;proguard-android.txt&#x27;</span>), <span class="string">&#x27;proguard-rules.pro&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    compileOptions &#123;</span><br><span class="line">        <span class="keyword">sourceCompatibility</span> JavaVersion.VERSION_1_8</span><br><span class="line">        <span class="keyword">targetCompatibility</span> JavaVersion.VERSION_1_8</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">dependencies</span> &#123;</span><br><span class="line">    implementation <span class="string">&#x27;com.zeroc:ice:3.6.4&#x27;</span></span><br><span class="line">    implementation <span class="keyword">fileTree</span>(<span class="keyword">include</span>: [<span class="string">&#x27;*.jar&#x27;</span>], dir: <span class="string">&#x27;libs&#x27;</span>)</span><br><span class="line">    <span class="comment">//  ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>在Gradle Projects里</p>
<ol>
<li>先编译slice。-&gt;compileSlice</li>
<li>然后生成应用项。-&gt;assembleDebug</li>
</ol>
<p>最后安装无误，顺利通过。</p>
<hr>
<br>

<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><ol>
<li><a target="_blank" rel="noopener" href="https://baike.baidu.com/item/ZeroC%20Ice">中文简单介绍</a></li>
<li><a target="_blank" rel="noopener" href="https://zeroc.com/">官网</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/robertaqi/article/details/5900695">某个博客</a></li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/2/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><span class="space">&hellip;</span><a class="page-number" href="/page/6/">6</a><a class="extend next" rel="next" href="/page/4/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="章亮"
      src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">章亮</p>
  <div class="site-description" itemprop="description">Developer For Android</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">54</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">4</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">52</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/zhangliangnbu" title="GitHub → https://github.com/zhangliangnbu" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:zhangliangnbu@qq.com" title="E-Mail → mailto:zhangliangnbu@qq.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">章亮</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
    <span title="站点总字数">199k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">3:01</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
